

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Device Passthrough &mdash; Project ACRN™ 2.3-unstable documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/ACRN-favicon-32x32.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'2.3-unstable',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-831873-64"></script>
        <script type="text/javascript" src="../../_static/acrn-custom.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/acrn-custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MMIO Device Passthrough" href="mmio-dev-passthrough.html" />
    <link rel="prev" title="VT-d" href="hv-vt-d.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Project ACRN™
          

          
            
            <img src="../../_static/ACRN_Logo_200w.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Project ACRN</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Versions</dt>
        
          <dd><a href="/latest/">latest</a></dd>
        
          <dd><a href="/2.2/">2.2</a></dd>
        
          <dd><a href="/2.1/">2.1</a></dd>
        
          <dd><a href="/2.0/">2.0</a></dd>
        
          <dd><a href="/1.6.1/">1.6.1</a></dd>
        
          <dd><a href="/1.6/">1.6</a></dd>
        
          <dd><a href="/1.5/">1.5</a></dd>
        
          <dd><a href="/1.4/">1.4</a></dd>
        
          <dd><a href="/1.0/">1.0</a></dd>
        
      </dl>
      <dl>
        <dt>projectacrn.org links</dt>
          <dd>
            <a href="https://www.projectacrn.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/projectacrn/acrn-hypervisor/wiki">Wiki</a>
          </dd>
      </dl>
    </div>
  </div>
  
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Documentation Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">What is ACRN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#introduction-to-project-acrn">Introduction to Project ACRN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#acrn-open-source-roadmap">ACRN Open Source Roadmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#acrn-high-level-architecture">ACRN High-Level Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#usage-scenarios">Usage Scenarios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../introduction/index.html#industrial-workload-consolidation">Industrial Workload Consolidation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../introduction/index.html#automotive-application-scenarios">Automotive Application Scenarios</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#best-known-configurations">Best Known Configurations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../introduction/index.html#sdc-scenario">SDC scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../introduction/index.html#industry-scenario">Industry scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../introduction/index.html#hybrid-scenario">Hybrid scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../introduction/index.html#hybrid-real-time-rt-scenario">Hybrid real-time (RT) scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../introduction/index.html#logical-partition-scenario">Logical Partition scenario</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#licensing">Licensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#acrn-device-model-service-vm-and-user-vm">ACRN Device Model, Service VM, and User VM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#boot-sequence">Boot Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#acrn-hypervisor-architecture">ACRN Hypervisor Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#acrn-device-model-architecture">ACRN Device Model Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#device-passthrough">Device passthrough</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../introduction/index.html#hardware-support-for-device-passthrough">Hardware support for device passthrough</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../introduction/index.html#hypervisor-support-for-device-passthrough">Hypervisor support for device passthrough</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#acrn-i-o-mediator">ACRN I/O mediator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#virtio-framework-architecture">Virtio framework architecture</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../try.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/hardware.html">Supported Hardware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/hardware.html#minimum-system-requirements-for-installing-acrn">Minimum System Requirements for Installing ACRN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/hardware.html#minimum-requirements-for-processor">Minimum Requirements for Processor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/hardware.html#known-limitations">Known Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/hardware.html#new-processor-families">New Processor Families</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/hardware.html#verified-platforms-according-to-acrn-usage">Verified Platforms According to ACRN Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/hardware.html#verified-hardware-specifications-detail">Verified Hardware Specifications Detail</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/building-from-source.html">Build ACRN from Source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/building-from-source.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/building-from-source.html#install-build-tools-and-dependencies">Install build tools and dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/building-from-source.html#get-the-acrn-hypervisor-source-code">Get the ACRN hypervisor source code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/building-from-source.html#build-with-the-acrn-scenario">Build with the ACRN scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/building-from-source.html#build-the-hypervisor-configuration">Build the hypervisor configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/building-from-source.html#modify-the-hypervisor-configuration">Modify the hypervisor configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/building-from-source.html#build-the-hypervisor-device-model-and-tools">Build the hypervisor, device model, and tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html">Getting Started Guide for ACRN Industry Scenario with Ubuntu Service VM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#verified-version">Verified version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#install-ubuntu-for-the-service-and-user-vms">Install Ubuntu for the Service and User VMs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#hardware-connection">Hardware Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#install-the-ubuntu-user-vm-rtvm-on-the-sata-disk">Install the Ubuntu User VM (RTVM) on the SATA disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#install-the-ubuntu-service-vm-on-the-nvme-disk">Install the Ubuntu Service VM on the NVMe disk</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#build-and-install-acrn-on-ubuntu">Build and Install ACRN on Ubuntu</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#pre-steps">Pre-Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#build-the-acrn-hypervisor-on-ubuntu">Build the ACRN Hypervisor on Ubuntu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#build-and-install-the-acrn-kernel">Build and install the ACRN kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#install-the-service-vm-kernel-and-modules">Install the Service VM kernel and modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#update-grub-for-the-ubuntu-service-vm">Update Grub for the Ubuntu Service VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#enable-network-sharing-for-the-user-vm">Enable network sharing for the User VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#reboot-the-system">Reboot the system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#additional-settings-in-the-service-vm">Additional settings in the Service VM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#launch-the-rtvm">Launch the RTVM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#update-the-grub-file">Update the Grub file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#id2">Launch the RTVM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#launch-the-windows-vm">Launch the Windows VM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#enabling-the-network-on-the-rtvm">Enabling the network on the RTVM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting-started/rt_industry_ubuntu.html#passthrough-a-hard-disk-to-rtvm">Passthrough a hard disk to RTVM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/using_hybrid_mode_on_nuc.html">Getting Started Guide for ACRN hybrid mode</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_hybrid_mode_on_nuc.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_hybrid_mode_on_nuc.html#update-ubuntu-grub">Update Ubuntu GRUB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_hybrid_mode_on_nuc.html#hybrid-scenario-startup-checking">Hybrid Scenario Startup Checking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/using_partition_mode_on_nuc.html">Getting Started Guide for ACRN logical partition mode</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_partition_mode_on_nuc.html#validated-versions">Validated Versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_partition_mode_on_nuc.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_partition_mode_on_nuc.html#update-kernel-image-and-modules-of-pre-launched-vm">Update kernel image and modules of pre-launched VM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_partition_mode_on_nuc.html#update-acrn-hypervisor-image">Update ACRN hypervisor image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_partition_mode_on_nuc.html#update-ubuntu-grub-to-boot-hypervisor-and-load-kernel-image">Update Ubuntu GRUB to boot hypervisor and load kernel image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_partition_mode_on_nuc.html#logical-partition-scenario-startup-checking">Logical partition scenario startup checking</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../develop.html">Advanced Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../develop.html#configuration-and-tools">Configuration and Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/acrn_configuration_tool.html">ACRN Configuration Tool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/acrn_configuration_tool.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/acrn_configuration_tool.html#acrn-configuration-xmls">ACRN configuration XMLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/acrn_configuration_tool.html#configuration-tool-workflow">Configuration tool workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/acrn_configuration_tool.html#use-the-acrn-configuration-app">Use the ACRN configuration app</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/kconfig/index.html">Configuration Symbol Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../reference/kconfig/index.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../reference/kconfig/index.html#supported-options">Supported Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guides/hv-parameters.html">ACRN Hypervisor Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user-guides/hv-parameters.html#generic-hypervisor-parameters">Generic hypervisor parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guides/kernel-parameters.html">ACRN Kernel Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user-guides/kernel-parameters.html#generic-kernel-parameters">Generic kernel parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user-guides/kernel-parameters.html#intel-gvt-g-acrngt-parameters">Intel GVT-g (AcrnGT) Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guides/acrn-shell.html">ACRN Shell Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user-guides/acrn-shell.html#command-examples">Command examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guides/acrn-dm-parameters.html">Device Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/tools/acrn-crashlog/README.html">ACRN-Crashlog</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/README.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/README.html#building">Building</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/README.html#installing">Installing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/README.html#enabling-disabling">Enabling/Disabling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/README.html#source-code">Source Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/packaging/README.html">ACRN Installation via Debian Packages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/packaging/README.html#set-up-prerequisites">Set up prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/packaging/README.html#configure-debian-packaging-details">Configure Debian packaging details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/packaging/README.html#run-the-package-building-script">Run the package-building script</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/packaging/README.html#prepare-your-target-system-with-ubuntu-18-04">Prepare your target system with Ubuntu 18.04</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/packaging/README.html#install-debian-packages-on-your-target-system">Install Debian packages on your target system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/packaging/README.html#boot-acrn-using-the-multiboot2-grub-choice">Boot ACRN using the multiboot2 grub choice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/packaging/README.html#verify-acrn-is-running">Verify ACRN is running</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/README.html">acrnprobe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/README.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/README.html#architecture">Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/README.html#source-files">Source files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/README.html#configuration-files">Configuration files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/conf.html">acrnprobe Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/conf.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/conf.html#layout">Layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/conf.html#properties-of-group-members">Properties of group members</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/conf.html#crash-tree-in-acrnprobe">Crash tree in acrnprobe</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/acrnprobe/conf.html#sections">Sections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/tools/acrn-crashlog/usercrash/README.html">usercrash</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/usercrash/README.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/usercrash/README.html#design">Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/usercrash/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrn-crashlog/usercrash/README.html#source-code">Source Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/tools/acrnlog/README.html">acrnlog</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrnlog/README.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrnlog/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrnlog/README.html#build-and-install">Build and Install</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/tools/acrntrace/README.html">acrntrace</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrntrace/README.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrntrace/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/tools/acrntrace/README.html#build-and-install">Build and Install</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/acrn-manager/README.html">acrnctl and acrnd</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/acrn-manager/README.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/acrn-manager/README.html#acrnd">acrnd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/acrn-manager/README.html#build-and-install">Build and Install</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../develop.html#service-vm-tutorials">Service VM Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/running_deb_as_serv_vm.html">Run Debian as the Service VM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_deb_as_serv_vm.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_deb_as_serv_vm.html#validated-versions">Validated Versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_deb_as_serv_vm.html#install-acrn-on-the-debian-vm">Install ACRN on the Debian VM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_yp.html">Using Yocto Project with ACRN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_yp.html#the-meta-acrn-layer">The meta-acrn layer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../develop.html#user-vm-tutorials">User VM Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_windows_as_uos.html">Launch Windows as the Guest VM on ACRN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_windows_as_uos.html#acrn-service-vm-setup">ACRN Service VM Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_windows_as_uos.html#setup-for-using-windows-as-the-guest-vm">Setup for Using Windows as the Guest VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_windows_as_uos.html#acrn-windows-verified-feature-list">ACRN Windows verified feature list</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_windows_as_uos.html#known-limitations">Known limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_windows_as_uos.html#explanation-for-acrn-dm-popular-command-lines">Explanation for acrn-dm popular command lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_windows_as_uos.html#secure-boot-enabling">Secure boot enabling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_windows_as_uos.html#activate-windows-10">Activate Windows 10</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/running_ubun_as_user_vm.html">Run Ubuntu as the User VM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_ubun_as_user_vm.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_ubun_as_user_vm.html#build-the-ubuntu-kvm-image">Build the Ubuntu KVM Image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_ubun_as_user_vm.html#launch-the-ubuntu-image-as-the-user-vm">Launch the Ubuntu Image as the User VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_ubun_as_user_vm.html#enable-the-ubuntu-console-instead-of-the-user-interface">Enable the Ubuntu Console instead of the User Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/running_deb_as_user_vm.html">Run Debian as the User VM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_deb_as_user_vm.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_deb_as_user_vm.html#build-the-debian-kvm-image">Build the Debian KVM Image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_deb_as_user_vm.html#launch-the-debian-image-as-the-user-vm">Launch the Debian Image as the User VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/running_deb_as_user_vm.html#enable-the-ttys0-console-on-the-debian-vm">Enable the ttyS0 Console on the Debian VM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_xenomai_as_uos.html">Run Xenomai as the User VM OS (Real-time VM)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_xenomai_as_uos.html#build-the-xenomai-kernel">Build the Xenomai kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_xenomai_as_uos.html#launch-the-rtvm">Launch the RTVM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_xenomai_as_uos.html#install-the-xenomai-libraries-and-tools">Install the Xenomai libraries and tools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_vxworks_as_uos.html">Run VxWorks as the User VM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_vxworks_as_uos.html#steps-for-using-vxworks-as-user-vm">Steps for Using VxWorks as User VM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_zephyr_as_uos.html">Run Zephyr as the User VM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_zephyr_as_uos.html#introduction-to-zephyr">Introduction to Zephyr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_zephyr_as_uos.html#steps-for-using-zephyr-as-user-vm">Steps for Using Zephyr as User VM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../develop.html#enable-acrn-features">Enable ACRN Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/sgx_virtualization.html">Enable SGX Virtualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/sgx_virtualization.html#high-level-acrn-sgx-virtualization-design">High Level ACRN SGX Virtualization Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/sgx_virtualization.html#enable-sgx-support-for-guest">Enable SGX support for Guest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/sgx_virtualization.html#sgx-capability-exposure">SGX Capability Exposure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/sgx_virtualization.html#enclave-system-function-handling">Enclave System Function Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/sgx_virtualization.html#other-vmexit-control">Other VMExit Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/sgx_virtualization.html#future-development">Future Development</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/vuart_configuration.html">Enable vUART Configurations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/vuart_configuration.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/vuart_configuration.html#console-enable-list">Console enable list</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/vuart_configuration.html#how-to-configure-a-console-port">How to configure a console port</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/vuart_configuration.html#how-to-configure-a-communication-port">How to configure a communication port</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/vuart_configuration.html#communication-vuart-enable-list">Communication vUART enable list</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/vuart_configuration.html#launch-script">Launch script</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/vuart_configuration.html#test-the-communication-port">Test the communication port</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/vuart_configuration.html#vuart-design">vUART design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/vuart_configuration.html#com-port-configurations-for-post-launched-vms">COM port configurations for Post-Launched VMs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/rdt_configuration.html">Enable RDT Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rdt_configuration.html#rdt-detection-and-resource-capabilities">RDT detection and resource capabilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rdt_configuration.html#tuning-rdt-resources-in-hv-debug-shell">Tuning RDT resources in HV debug shell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rdt_configuration.html#configure-rdt-for-vm-using-vm-configuration">Configure RDT for VM using VM Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/waag-secure-boot.html">Enable Secure Boot in Windows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/waag-secure-boot.html#generate-platform-key-pk">Generate Platform Key (PK)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/waag-secure-boot.html#download-kek-and-db-from-microsoft">Download KEK and DB from Microsoft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/waag-secure-boot.html#compile-ovmf-with-secure-boot-support">Compile OVMF with secure boot support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/waag-secure-boot.html#use-qemu-to-inject-secure-boot-keys-into-ovmf">Use QEMU to inject secure boot keys into OVMF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/enable_s5.html">Enable S5 in ACRN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/enable_s5.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/enable_s5.html#s5-architecture">S5 Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/enable_s5.html#id1">Enable S5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/enable_s5.html#how-to-test">How to test</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/cpu_sharing.html">Enable CPU Sharing in ACRN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/cpu_sharing.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/cpu_sharing.html#scheduling-framework">Scheduling Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/cpu_sharing.html#cpu-affinity">CPU affinity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/cpu_sharing.html#thread-object-state">Thread object state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/cpu_sharing.html#scheduler">Scheduler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/cpu_sharing.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/sriov_virtualization.html">Enable SR-IOV Virtualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/sriov_virtualization.html#sr-iov-architectural-overview">SR-IOV Architectural Overview</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/gpu-passthru.html">Enable GVT-d in ACRN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/gpu-passthru.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/gpu-passthru.html#verified-version">Verified version</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/gpu-passthru.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/gpu-passthru.html#supported-hardware-platform">Supported hardware platform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/gpu-passthru.html#bios-settings">BIOS settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/gpu-passthru.html#passthrough-the-gpu-to-guest">Passthrough the GPU to Guest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/gpu-passthru.html#enable-the-gvt-d-gop-driver">Enable the GVT-d GOP driver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/run_kata_containers.html">Run Kata Containers on a Service VM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/run_kata_containers.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/run_kata_containers.html#install-docker">Install Docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/run_kata_containers.html#install-kata-containers">Install Kata Containers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/run_kata_containers.html#run-a-kata-container-with-acrn">Run a Kata Container with ACRN</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/trustyACRN.html">Trusty and Security Services Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/trustyACRN.html#trusty-architecture">Trusty Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/trustyACRN.html#trusty-services">Trusty Services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/trustyACRN.html#trusty-in-acrn">Trusty in ACRN</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/rtvm_workload_design_guideline.html">Real-time VM Application Design Guidelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rtvm_workload_design_guideline.html#run-rtvm-with-dedicated-resources-devices">Run RTVM with dedicated resources/devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rtvm_workload_design_guideline.html#rtvm-with-virtio-pmd-polling-mode-driver-for-i-o-sharing">RTVM with virtio PMD (Polling Mode Driver) for I/O sharing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rtvm_workload_design_guideline.html#rtvm-with-hv-emulated-device">RTVM with HV Emulated Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rtvm_workload_design_guideline.html#dm-emulated-device-except-pmd">DM emulated device (Except PMD)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/setup_openstack_libvirt.html">Configure ACRN using OpenStack and libvirt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/setup_openstack_libvirt.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/setup_openstack_libvirt.html#install-acrn">Install ACRN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/setup_openstack_libvirt.html#set-up-and-launch-lxc-lxd">Set up and launch LXC/LXD</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/setup_openstack_libvirt.html#set-up-acrn-prerequisites-inside-the-container">Set up ACRN prerequisites inside the container</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/setup_openstack_libvirt.html#set-up-libvirt">Set up libvirt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/setup_openstack_libvirt.html#set-up-openstack">Set up OpenStack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/setup_openstack_libvirt.html#configure-and-create-openstack-instance">Configure and create OpenStack Instance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/setup_openstack_libvirt.html#final-steps">Final Steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/acrn_on_qemu.html">Enable ACRN over QEMU/KVM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/acrn_on_qemu.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/acrn_on_qemu.html#prepare-service-vm-l1-guest">Prepare Service VM (L1 Guest)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/acrn_on_qemu.html#install-acrn-hypervisor">Install ACRN Hypervisor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/acrn_on_qemu.html#service-vm-networking-updates-for-user-vm">Service VM Networking updates for User VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/acrn_on_qemu.html#bring-up-user-vm-l2-guest">Bring-up User VM (L2 Guest)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_grub.html">Using GRUB to boot ACRN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_grub.html#using-pre-installed-grub">Using pre-installed GRUB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/using_grub.html#installing-self-built-grub">Installing self-built GRUB</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/pre-launched-rt.html">Pre-Launched Preempt-RT Linux Mode in ACRN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/pre-launched-rt.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/pre-launched-rt.html#example-of-pre-launched-rt">Example of Pre-Launched RT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/enable_ivshmem.html">Enable Inter-VM Communication Based on <code class="docutils literal notranslate"><span class="pre">ivshmem</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/enable_ivshmem.html#ivshmem-dm-land-usage">ivshmem dm-land usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/enable_ivshmem.html#ivshmem-hv-land-usage">ivshmem hv-land usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/enable_ivshmem.html#inter-vm-communication-examples">Inter-VM Communication Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../develop.html#debug">Debug</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/using_serial_port.html">Using the Serial Port on KBL Intel NUC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/debug.html">ACRN Debugging Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/debug.html#acrn-console-command">ACRN Console Command</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/debug.html#an-example">An example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/debug.html#acrn-log">ACRN Log</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/debug.html#acrn-trace">ACRN Trace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/realtime_performance_tuning.html">ACRN Real-time (RT) Performance Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/realtime_performance_tuning.html#vmexit-analysis-for-acrn-rt-performance"><code class="docutils literal notranslate"><span class="pre">vmexit</span></code> analysis for ACRN RT performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/realtime_performance_tuning.html#collecting-performance-monitoring-counters-data">Collecting Performance Monitoring Counters data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/rtvm_performance_tips.html">ACRN Real-time VM Performance Tips</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rtvm_performance_tips.html#background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rtvm_performance_tips.html#mandatory-options-for-an-rtvm">Mandatory options for an RTVM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rtvm_performance_tips.html#avoid-vm-exit-latency">Avoid VM-exit latency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rtvm_performance_tips.html#isolating-the-impact-of-neighbor-vms">Isolating the impact of neighbor VMs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/rtvm_performance_tips.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../contribute.html">Developer Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../contribute.html#design-guides">Design Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../modularity.html">ACRN Hypervisor: Modular Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modularity.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modularity.html#principles">Principles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modularity.html#architecture">Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modularity.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">High-Level Design Guides</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="hld-overview.html">Overview</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="hld-hypervisor.html">Hypervisor</a></li>
<li class="toctree-l4"><a class="reference internal" href="hld-devicemodel.html">Device Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="hld-emulated-devices.html">Emulated Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="hld-virtio-devices.html">Virtio Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="hld-power-management.html">Power Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="hld-trace-log.html">Tracing and Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="hld-vsbl.html">Virtual Bootloader</a></li>
<li class="toctree-l4"><a class="reference internal" href="hld-security.html">Security</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sw_design_guidelines.html">Software Design Guidelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sw_design_guidelines.html#error-detection-and-error-handling">Error Detection and Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sw_design_guidelines.html#module-level-configuration-design-guidelines">Module Level Configuration Design Guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sw_design_guidelines.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../GVT-g-porting.html">GVT-g Enabling and Porting Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../GVT-g-porting.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../GVT-g-porting.html#purpose-of-this-document">Purpose of this document</a></li>
<li class="toctree-l4"><a class="reference internal" href="../GVT-g-porting.html#overall-components">Overall Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../GVT-g-porting.html#core-scenario-interaction-sequences">Core scenario interaction sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../GVT-g-porting.html#api-details">API details</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../trusty.html">Trusty TEE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../trusty.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../trusty.html#trusty-architecture">Trusty Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../trusty.html#trusty-specific-hypercalls">Trusty specific Hypercalls</a></li>
<li class="toctree-l4"><a class="reference internal" href="../trusty.html#trusty-boot-flow">Trusty Boot flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../trusty.html#ept-hierarchy">EPT Hierarchy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../l1tf.html">L1 Terminal Fault Mitigation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../l1tf.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../l1tf.html#l1tf-problem-in-acrn">L1TF Problem in ACRN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../l1tf.html#l1tf-mitigation-in-acrn">L1TF Mitigation in ACRN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../l1tf.html#mitigation-recommendations">Mitigation Recommendations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../l1tf.html#mitigation-status">Mitigation Status</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../VBSK-analysis.html">VBS-K Framework Virtualization Overhead Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../VBSK-analysis.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../VBSK-analysis.html#architecture-of-virtio-echo">Architecture of VIRTIO-ECHO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../VBSK-analysis.html#virtualization-overhead-analysis">Virtualization Overhead Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../VBSK-analysis.html#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute.html#contribute-guides">Contribute Guides</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contribute_guidelines.html">Contribution Guidelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../contribute_guidelines.html#licensing">Licensing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../contribute_guidelines.html#developer-certification-of-origin-dco">Developer Certification of Origin (DCO)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../contribute_guidelines.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../contribute_guidelines.html#repository-layout">Repository layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../contribute_guidelines.html#submitting-issues">Submitting Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../contribute_guidelines.html#contribution-tools-and-git-setup">Contribution Tools and Git Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../contribute_guidelines.html#coding-style">Coding Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../contribute_guidelines.html#contribution-workflow">Contribution Workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../contribute_guidelines.html#commit-guidelines">Commit Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../coding_guidelines.html">Coding Guidelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../c_coding_guidelines.html">C Programming Language Coding Guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../asm_coding_guidelines.html">Assembly Language Coding Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../doc_guidelines.html">Documentation Guidelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#headings">Headings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#content-highlighting">Content Highlighting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#lists">Lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#multi-column-lists">Multi-column lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#tables">Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#file-names-and-commands">File names and Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#internal-cross-reference-linking">Internal Cross-Reference Linking</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#non-ascii-characters">Non-ASCII Characters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#code-and-command-examples">Code and Command Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#images">Images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#tabs-spaces-and-indenting">Tabs, spaces, and indenting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#drawings">Drawings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#alternative-tabbed-content">Alternative Tabbed Content</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#instruction-steps">Instruction Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#first-instruction-step">First instruction step</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#second-instruction-step">Second instruction step</a></li>
<li class="toctree-l4"><a class="reference internal" href="../doc_guidelines.html#documentation-generation">Documentation Generation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../graphviz.html">Drawings using graphviz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../graphviz.html#simple-directed-graph">Simple directed graph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../graphviz.html#adding-edge-labels">Adding edge labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../graphviz.html#tables">Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../graphviz.html#finite-state-machine">Finite-State Machine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/docbuild.html">ACRN documentation generation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/docbuild.html#documentation-overview">Documentation overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/docbuild.html#set-up-the-documentation-working-folders">Set up the documentation working folders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/docbuild.html#installing-the-documentation-tools">Installing the documentation tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/docbuild.html#documentation-presentation-theme">Documentation presentation theme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/docbuild.html#running-the-documentation-processors">Running the documentation processors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/docbuild.html#publishing-content">Publishing content</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/docbuild.html#document-versioning">Document Versioning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorials/docbuild.html#filtering-expected-warnings">Filtering expected warnings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute.html#api-documentation">API Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/index.html">API Documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/hypercall_api.html">Hypercall APIs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/devicemodel_api.html">Device Model APIs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/GVT-g_api.html">ACRN GVT-g APIs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes/index.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_2.2.html">ACRN v2.2 (Sep 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_2.2.html#what-s-new-in-v2-2">What’s New in v2.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_2.2.html#document-updates">Document updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_2.2.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_2.2.html#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_2.1.html">ACRN v2.1 (Aug 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_2.1.html#what-s-new-in-v2-1">What’s new in v2.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_2.1.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_2.1.html#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_2.0.html">ACRN v2.0 (Jun 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#version-2-0-key-features-comparing-with-v1-0">Version 2.0 Key Features (comparing with v1.0)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#acrn-architecture-upgrade-to-support-hybrid-mode">ACRN Architecture Upgrade to Support Hybrid Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#new-hardware-platform-support">New Hardware Platform Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#pre-launched-safety-vm-support">Pre-launched Safety VM Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#post-launched-vm-support-via-ovmf">Post-launched VM support via OVMF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#post-launched-real-time-vm-support">Post-launched real-time VM Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#real-time-vm-performance-optimizations">Real-time VM Performance Optimizations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#cpu-sharing-support">CPU Sharing Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#large-selection-of-oss-for-user-vms">Large selection of OSs for User VMs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#grub-bootloader">GRUB bootloader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#sr-iov-support">SR-IOV Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#graphics-passthrough-support">Graphics passthrough support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#shared-memory-based-inter-vm-communication">Shared memory based Inter-VM communication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#configuration-tool-support">Configuration Tool Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#kata-containers-support">Kata Containers Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#vm-orchestration">VM orchestration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_2.0.html#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_1.6.1.html">ACRN v1.6.1 (May 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.6.1.html#version-1-6-1-major-features">Version 1.6.1 major features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.6.1.html#what-s-new-in-v1-6-1">What’s New in v1.6.1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.6.1.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.6.1.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.6.1.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.6.1.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_1.6.html">ACRN v1.6 (Mar 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.6.html#version-1-6-major-features">Version 1.6 major features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.6.html#what-s-new-in-v1-6">What’s New in v1.6</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.6.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.6.html#new-features-details">New Features Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.6.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.6.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.6.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_1.5.html">ACRN v1.5 (Jan 2020)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.5.html#version-1-5-major-features">Version 1.5 major features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.5.html#what-s-new-in-v1-5">What’s New in v1.5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.5.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.5.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.5.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.5.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_1.4.html">ACRN v1.4 (Oct 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.4.html#version-1-4-major-features">Version 1.4 major features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.4.html#what-s-new-in-v1-4">What’s New in v1.4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.4.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.4.html#security-vulnerabilities">Security Vulnerabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.4.html#new-features-details">New Features Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.4.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.4.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.4.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_1.3.html">ACRN v1.3 (Sep 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.3.html#version-1-3-major-features">Version 1.3 major features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.3.html#what-s-new-in-v1-3">What’s New in v1.3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.3.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.3.html#new-features-details">New Features Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.3.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.3.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.3.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_1.2.html">ACRN v1.2 (Aug 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.2.html#version-1-2-major-features">Version 1.2 major features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.2.html#what-s-new-in-v1-2">What’s New in v1.2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.2.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.2.html#new-features-details">New Features Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.2.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.2.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.2.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_1.1.html">ACRN v1.1 (Jun 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.1.html#version-1-1-major-features">Version 1.1 major features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.1.html#hybrid-mode-introduced">Hybrid Mode Introduced</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.1.html#support-for-new-guest-operating-systems">Support for new guest Operating Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.1.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.1.html#new-features-details">New Features Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.1.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.1.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.1.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_1.0.2.html">ACRN v1.0.2 (Nov 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.0.2.html#change-log-in-v1-0-2-since-v1-0-1">Change Log in v1.0.2 since v1.0.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_1.0.1.html">ACRN v1.0.1 (July 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.0.1.html#change-log-in-version-1-0-1-since-version-1-0">Change Log in version 1.0.1 since version 1.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_1.0.html">ACRN v1.0 (May 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#version-1-0-major-features">Version 1.0 major features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#hardware-support">Hardware Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#apl-up2-board-with-sbl-firmware">APL UP2 board with SBL firmware</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#enable-post-launched-rtvm-support-for-real-time-uos-in-acrn">Enable post-launched RTVM support for real-time UOS in ACRN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#enable-cache-qos-with-cat">Enable cache QOS with CAT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#enable-qos-based-on-runc-container">Enable QoS based on runC container</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#s5-support-for-rtvm">S5 support for RTVM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#ovmf-support-initial-patches-merged-in-acrn">OVMF support initial patches merged in ACRN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#support-acpi-power-key-mediator">Support ACPI power key mediator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#vt-x-vt-d">VT-x, VT-d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#pic-ioapic-msi-msi-x-pci-lapic">PIC/IOAPIC/MSI/MSI-X/PCI/LAPIC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#ethernet">Ethernet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#mass-storage">Mass Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#usb-xdci">USB (xDCI)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#usb-mediator-xhci">USB Mediator (xHCI)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#wi-fi">Wi-Fi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#ipu-mipi-csi-2-hdmi-in">IPU (MIPI CSI-2, HDMI-in)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#bluetooth">Bluetooth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#gvt-g-for-acrn">GVT-g for ACRN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#gpu-preemption">GPU - Preemption</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#gpu-display-surface-sharing-via-hyper-dma">GPU - display surface sharing via Hyper DMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#virtio-standard-is-supported">Virtio standard is supported</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#device-pass-through-support">Device pass-through support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#gpio-virtualization">GPIO virtualization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#new-acrn-tools">New ACRN tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#new-features-details">New Features Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_1.0.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_0.8.html">ACRN v0.8 (Apr 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.8.html#version-0-8-new-features">Version 0.8 new features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.8.html#gpio-virtualization">GPIO virtualization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.8.html#enable-qos-based-on-runc-container">Enable QoS based on runC container</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.8.html#s5-support-for-rtvm">S5 support for RTVM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.8.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.8.html#new-features-details">New Features Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.8.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.8.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.8.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_0.7.html">ACRN v0.7 (Mar 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.7.html#version-0-7-new-features">Version 0.7 new features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.7.html#enable-cache-qos-with-cat">Enable cache QOS with CAT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.7.html#support-acpi-power-key-mediator">Support ACPI power key mediator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.7.html#document-updates">Document updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.7.html#new-features-details">New Features Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.7.html#fixed-issues-details">Fixed Issues Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.7.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.7.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_0.6.html">ACRN v0.6 (Feb 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.6.html#version-0-6-new-features">Version 0.6 new features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.6.html#fixed-issues">Fixed Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.6.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.6.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_0.5.html">ACRN v0.5 (Jan 2019)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.5.html#version-0-5-new-features">Version 0.5 new features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.5.html#fixed-issues">Fixed Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.5.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.5.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_0.4.html">ACRN v0.4 (Dec 2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.4.html#version-0-4-new-features">Version 0.4 new features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.4.html#fixed-issues">Fixed Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.4.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.4.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_0.3.html">ACRN v0.3 (Nov 2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.3.html#version-0-3-new-features">Version 0.3 new features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.3.html#fixed-issues">Fixed Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.3.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.3.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_0.2.html">ACRN v0.2 (Sep 2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#version-0-2-new-features">Version 0.2 new features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#vt-x-vt-d">VT-x, VT-d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#pic-ioapic-msi-msi-x-pci-lapic">PIC/IOAPIC/MSI/MSI-X/PCI/LAPIC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#ethernet">Ethernet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#storage-emmc">Storage (eMMC)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#usb-xdci">USB (xDCI)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#usb-mediator-xhci-and-drd">USB Mediator (xHCI and DRD)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#csme">CSME</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#wifi">WiFi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#ipu-mipi-cs2-hdmi-in">IPU (MIPI-CS2, HDMI-in)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#bluetooth">Bluetooth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#gpu-preemption">GPU  - Preemption</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#gpu-display-surface-sharing-via-hyper-dma">GPU - display surface sharing via Hyper DMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#s3">S3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#fixed-issues">Fixed Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.2.html#change-log">Change Log</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes/release_notes_0.1.html">ACRN v0.1 (July 2018)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.1.html#version-0-1-new-features">Version 0.1 new features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.1.html#hardware-support">Hardware Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.1.html#gvt-g-for-acrn">GVT-g for ACRN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.1.html#virtio-standard-is-supported">Virtio standard is supported</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.1.html#device-pass-through-support">Device pass-through support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.1.html#hypervisor-configuration">Hypervisor configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../release_notes/release_notes_0.1.html#new-acrn-tools">New ACRN tools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.1.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../release_notes/release_notes_0.1.html#change-log">Change Log</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../asa.html">Security Advisory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../asa.html#addressed-in-acrn-v2-1">Addressed in ACRN v2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../asa.html#addressed-in-acrn-v1-6-1">Addressed in ACRN v1.6.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../asa.html#addressed-in-acrn-v1-6">Addressed in ACRN v1.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../asa.html#addressed-in-acrn-v1-4">Addressed in ACRN v1.4</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../faq.html#what-hardware-does-acrn-support">What hardware does ACRN support?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq.html#how-do-i-configure-acrn-s-memory-size">How do I configure ACRN’s memory size?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq.html#how-to-modify-the-default-display-output-for-a-user-vm">How to modify the default display output for a User VM?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq.html#why-does-acrn-need-to-know-how-much-ram-the-system-has">Why does ACRN need to know how much RAM the system has?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary of Terms</a></li>
</ul>

            
          

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Project ACRN™</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
  <!-- Latest -->
  
  

  <li><a href="../../index.html">Latest</a> &raquo;</li>
  
     <li><a href="../../contribute.html">Developer Reference</a> &raquo;</li>
  
     <li><a href="index.html">High-Level Design Guides</a> &raquo;</li>
  
     <li><a href="hld-hypervisor.html">Hypervisor high-level design</a> &raquo;</li>
  
  <li>Device Passthrough</li>

    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="device-passthrough">
<span id="hv-device-passthrough"></span><h1>Device Passthrough<a class="headerlink" href="#device-passthrough" title="Permalink to this headline">¶</a></h1>
<p>A critical part of virtualization is virtualizing devices: exposing all
aspects of a device including its I/O, interrupts, DMA, and
configuration.  There are three typical device virtualization methods:
emulation, para-virtualization, and passthrough.  All emulation,
para-virtualization and passthrough are used in ACRN project. Device
emulation is discussed in <a class="reference internal" href="hv-io-emulation.html#hld-io-emulation"><span class="std std-ref">I/O Emulation high-level design</span></a>, para-virtualization
is discussed in <a class="reference internal" href="hld-virtio-devices.html#hld-virtio-devices"><span class="std std-ref">Virtio devices high-level design</span></a> and device passthrough will be
discussed here.</p>
<p>In the ACRN project, device emulation means emulating all existing
hardware resource through a software component device model running in
the Service OS (SOS). Device emulation must maintain the same SW
interface as a native device, providing transparency to the VM software
stack. Passthrough implemented in hypervisor assigns a physical device
to a VM so the VM can access the hardware device directly with minimal
(if any) VMM involvement.</p>
<p>The difference between device emulation and passthrough is shown in
<a class="reference internal" href="#emu-passthru-diff"><span class="std std-numref">Figure 197</span></a>. You can notice device emulation has
a longer access path which causes worse performance compared with
passthrough. Passthrough can deliver near-native performance, but
can’t support device sharing.</p>
<div class="figure align-center" id="emu-passthru-diff">
<img alt="../../_images/passthru-image30.png" src="../../_images/passthru-image30.png" />
<p class="caption"><span class="caption-number">Figure 197 </span><span class="caption-text">Difference between Emulation and passthrough</span></p>
</div>
<p>Passthrough in the hypervisor provides the following functionalities to
allow VM to access PCI devices directly:</p>
<ul class="simple">
<li>VT-d DMA Remapping for PCI devices: hypervisor will setup DMA
remapping during VM initialization phase.</li>
<li>VT-d Interrupt-remapping for PCI devices: hypervisor will enable
VT-d interrupt-remapping for PCI devices for security considerations.</li>
<li>MMIO Remapping between virtual and physical BAR</li>
<li>Device configuration Emulation</li>
<li>Remapping interrupts for PCI devices</li>
<li>ACPI configuration Virtualization</li>
<li>GSI sharing violation check</li>
</ul>
<p>The following diagram details passthrough initialization control flow in ACRN
for post-launched VM:</p>
<div class="figure align-center" id="id2">
<img alt="../../_images/passthru-image22.png" src="../../_images/passthru-image22.png" />
<p class="caption"><span class="caption-number">Figure 198 </span><span class="caption-text">Passthrough devices initialization control flow</span></p>
</div>
<div class="section" id="passthrough-device-status">
<h2>Passthrough Device status<a class="headerlink" href="#passthrough-device-status" title="Permalink to this headline">¶</a></h2>
<p>Most common devices on supported platforms are enabled for
passthrough, as detailed here:</p>
<div class="figure align-center" id="id3">
<img alt="../../_images/passthru-image77.png" src="../../_images/passthru-image77.png" />
<p class="caption"><span class="caption-number">Figure 199 </span><span class="caption-text">Passthrough Device Status</span></p>
</div>
</div>
<div class="section" id="owner-of-passthrough-devices">
<h2>Owner of Passthrough Devices<a class="headerlink" href="#owner-of-passthrough-devices" title="Permalink to this headline">¶</a></h2>
<p>ACRN hypervisor will do PCI enumeration to discover the PCI devices on the platform.
According to the hypervisor/VM configurations, the owner of these PCI devices can be
one the following 4 cases:</p>
<ul class="simple">
<li><strong>Hypervisor</strong>: hypervisor uses UART device as the console in debug version for
debug purpose, so the UART device is owned by hypervisor and is not visible
to any VM. For now, UART is the only pci device could be owned by hypervisor.</li>
<li><strong>Pre-launched VM</strong>: The passthrough devices will be used in a pre-launched VM is
pre-defined in VM configuration. These passthrough devices are owned by the
pre-launched VM after the VM is created. These devices will not be removed
from the pre-launched VM. There could be pre-launched VM(s) in logical partition
mode and hybrid mode.</li>
<li><strong>Service VM</strong>: All the passthrough devices except these described above (owned by
hypervisor or pre-launched VM(s)) are assigned to Service VM. And some of these devices
can be assigned to a post-launched VM according to the passthrough device list
specified in the parameters of the ACRN DM.</li>
<li><strong>Post-launched VM</strong>: A list of passthrough devices can be specified in the parameters of
the ACRN DM. When creating a post-launched VM, these specified devices will be moved
from Service VM domain to the post-launched VM domain. After the post-launched VM is
powered-off, these devices will be moved back to Service VM domain.</li>
</ul>
</div>
<div class="section" id="vt-d-dma-remapping">
<h2>VT-d DMA Remapping<a class="headerlink" href="#vt-d-dma-remapping" title="Permalink to this headline">¶</a></h2>
<p>To enable passthrough, for VM DMA access the VM can only
support GPA, while physical DMA requires HPA. One work-around
is building identity mapping so that GPA is equal to HPA, but this
is not recommended as some VM don’t support relocation well. To
address this issue, Intel introduces VT-d in the chipset to add one
remapping engine to translate GPA to HPA for DMA operations.</p>
<p>Each VT-d engine (DMAR Unit), maintains a remapping structure
similar to a page table with device BDF (Bus/Dev/Func) as input and final
page table for GPA/HPA translation as output. The GPA/HPA translation
page table is similar to a normal multi-level page table.</p>
<p>VM DMA depends on Intel VT-d to do the translation from GPA to HPA, so we
need to enable VT-d IOMMU engine in ACRN before we can passthrough any device. Service VM
in ACRN is a VM running in non-root mode which also depends
on VT-d to access a device. In Service VM DMA remapping
engine settings, GPA is equal to HPA.</p>
<p>ACRN hypervisor checks DMA-Remapping Hardware unit Definition (DRHD) in
host DMAR ACPI table to get basic info, then sets up each DMAR unit. For
simplicity, ACRN reuses EPT table as the translation table in DMAR
unit for each passthrough device. The control flow of assigning and de-assigning
a passthrough device to/from a post-launched VM is shown in the following figures:</p>
<div class="figure align-center" id="id4">
<img alt="../../_images/passthru-image86.png" src="../../_images/passthru-image86.png" />
<p class="caption"><span class="caption-number">Figure 200 </span><span class="caption-text">ptdev assignment control flow</span></p>
</div>
<div class="figure align-center" id="id5">
<img alt="../../_images/passthru-image42.png" src="../../_images/passthru-image42.png" />
<p class="caption"><span class="caption-number">Figure 201 </span><span class="caption-text">ptdev de-assignment control flow</span></p>
</div>
</div>
<div class="section" id="vt-d-interrupt-remapping">
<span id="vtd-posted-interrupt"></span><h2>VT-d Interrupt-remapping<a class="headerlink" href="#vt-d-interrupt-remapping" title="Permalink to this headline">¶</a></h2>
<p>The VT-d interrupt-remapping architecture enables system software to
control and censor external interrupt requests generated by all sources
including those from interrupt controllers (I/OxAPICs), MSI/MSI-X capable
devices including endpoints, root-ports and Root-Complex integrated
end-points.
ACRN forces to enabled VT-d interrupt-remapping feature for security reasons.
If the VT-d hardware doesn’t support interrupt-remapping, then ACRN will
refuse to boot VMs.
VT-d Interrupt-remapping is NOT related to the translation from physical
interrupt to virtual interrupt or vice versa. The term VT-d interrupt-remapping
remaps the interrupt index in the VT-d interrupt-remapping table to the physical
interrupt vector after checking the external interrupt request is valid. Translation
physical vector to virtual vector is still needed to be done by hypervisor, which is
also described in the below section <a class="reference internal" href="#interrupt-remapping"><span class="std std-ref">Interrupt Remapping</span></a>.</p>
<p>VT-d posted interrupt (PI) enables direct delivery of external interrupts from
passthrough devices to VMs without having to exit to hypervisor, thereby improving
interrupt performance. ACRN uses VT-d posted interrupts if the platform
supports them. VT-d distinguishes between remapped
and posted interrupt modes by bit 15 in the low 64-bit of the IRTE. If cleared the
entry is remapped, if set it’s posted.
The idea for posted interrupt is to keep a Posted Interrupt Descriptor (PID) in memory.
The PID is a 64-byte data structure that contains several fields:</p>
<dl class="docutils">
<dt>Posted Interrupt Request (PIR):</dt>
<dd>a 256-bit field, one bit per request vector;
this is where the interrupts are posted;</dd>
<dt>Suppress Notification (SN):</dt>
<dd>determines whether to notify (<code class="docutils literal notranslate"><span class="pre">SN=0</span></code>) or not notify (<code class="docutils literal notranslate"><span class="pre">SN=1</span></code>)
the CPU for non-urgent interrupts. For ACRN,
all interrupts are treated as non-urgent. ACRN sets SN=0 during initialization
and then never changes it at runtime;</dd>
<dt>Notification Vector (NV):</dt>
<dd>the CPU must be notified with an interrupt and this
field specifies the vector for notification;</dd>
<dt>Notification Destination (NDST):</dt>
<dd>the physical APIC-ID of the destination.
ACRN does not support vCPU migration, one vCPU always runs on the same pCPU,
so for ACRN, NDST is never changed after initialization.</dd>
<dt>Outstanding Notification (ON):</dt>
<dd>indicates if a notification event is outstanding</dd>
</dl>
<p>The ACRN scheduler supports vCPU scheduling, where two or more vCPUs can
share the same pCPU using a time sharing technique. One issue emerges
here for VT-d posted interrupt handling process, where IRQs could happen
when the target vCPU is in a halted state. We need to handle the case
where the running vCPU disrupted by the external interrupt, is not the
target vCPU that an external interrupt should be delivered.</p>
<p>Consider this scenario:</p>
<ul class="simple">
<li>vCPU0 runs on pCPU0 and then enters a halted state,</li>
<li>ACRN scheduler now chooses vCPU1 to run on pCPU0.</li>
</ul>
<p>If an external interrupt from an assigned device destined to vCPU0
happens at this time, we do not want this interrupt to be incorrectly
consumed by vCPU1 currently running on pCPU0. This would happen if we
allocate the same Activation Notification Vector (ANV) to all vCPUs.</p>
<p>To circumvent this issue, ACRN allocates unique ANVs for each vCPU that
belongs to the same pCPU. The ANVs need only be unique within each pCPU,
not across all vCPUs. Since vCPU0’s ANV is different from vCPU1’s ANV,
if a vCPU0 is in a halted state, external interrupts from an assigned
device destined to vCPU0 delivered through the PID will not trigger the
posted interrupt processing. Instead, a VMExit to ACRN happens that can
then process the event such as waking up the halted vCPU0 and kick it
to run on pCPU0.</p>
<p>For ACRN, <code class="docutils literal notranslate"><span class="pre">CONFIG_MAX_VM_NUM</span></code> vCPUs may be running on top of a pCPU. ACRN
does not support two vCPUs of the same VM running on top of the same
pCPU. This reduces the number of pre-allocated ANVs for posted
interrupts to <code class="docutils literal notranslate"><span class="pre">CONFIG_MAX_VM_NUM</span></code>, and enables ACRN to avoid switching
between active and wake-up vector values in the posted interrupt
descriptor on vCPU scheduling state changes. ACRN uses the following
formula to assign posted interrupt vectors to vCPUs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NV</span> <span class="o">=</span> <span class="n">POSTED_INTR_VECTOR</span> <span class="o">+</span> <span class="n">vcpu</span><span class="o">-&gt;</span><span class="n">vm</span><span class="o">-&gt;</span><span class="n">vm_id</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">POSTED_INTR_VECTOR</span></code> is the starting vector (0xe3) for posted interrupts.</p>
<p>ACRN maintains a per-PCPU vCPU array that stores the pointers to
assigned vCPUs for each pCPU and is indexed by <code class="docutils literal notranslate"><span class="pre">vcpu-&gt;vm-&gt;vm_id</span></code>.
When the vCPU is created, ACRN adds the vCPU to the containing pCPU’s
vCPU array. When the vCPU is offline, ACRN removes the vCPU from the
related vCPU array.</p>
<p>An example to illustrate our solution:</p>
<div class="figure align-center">
<img alt="../../_images/passthru-image50.png" src="../../_images/passthru-image50.png" />
</div>
<p>ACRN sets <code class="docutils literal notranslate"><span class="pre">SN=0</span></code> during initialization and then never change it at
runtime. This means posted interrupt notification is never suppressed.
After posting the interrupt in Posted Interrupt Request (PIR), VT-d will
always notify the CPU using the interrupt vector NV, in both root and
non-root mode. With this scheme, if the target vCPU is running under
VMX non-root mode, it will receive the interrupts coming from
passed-through device without a VMExit (and therefore without any
intervention of the ACRN hypervisor).</p>
<p>If the target vCPU is in a halted state (under VMX non-root mode), a
scheduling request will be raised to wake it up. This is needed to
achieve real time behavior. If an RT-VM is waiting for an event, when
the event is fired (a PI interrupt fires), we need to wake up the VM
immediately.</p>
</div>
<div class="section" id="mmio-remapping">
<h2>MMIO Remapping<a class="headerlink" href="#mmio-remapping" title="Permalink to this headline">¶</a></h2>
<p>For PCI MMIO BAR, hypervisor builds EPT mapping between virtual BAR and
physical BAR, then VM can access MMIO directly.
There is one exception, MSI-X table is also in a MMIO BAR. Hypervisor needs to trap the
accesses to MSI-X table. So the page(s) having MSI-X table should not be accessed by guest
directly. EPT mapping is not built for these pages having MSI-X table.</p>
</div>
<div class="section" id="device-configuration-emulation">
<h2>Device configuration emulation<a class="headerlink" href="#device-configuration-emulation" title="Permalink to this headline">¶</a></h2>
<p>The PCI configuration space can be accessed by a PCI-compatible
Configuration Mechanism (IO port 0xCF8/CFC) and the PCI Express Enhanced
Configuration Access Mechanism (PCI MMCONFIG). The ACRN hypervisor traps
this PCI configuration space access and emulate it. Refer to <a class="reference internal" href="split-dm.html#split-device-model"><span class="std std-ref">Split Device Model</span></a> for details.</p>
</div>
<div class="section" id="msi-x-table-emulation">
<h2>MSI-X table emulation<a class="headerlink" href="#msi-x-table-emulation" title="Permalink to this headline">¶</a></h2>
<p>VM accesses to MSI-X table should be trapped so that hypervisor has the
information to map the virtual vector and physical vector. EPT mapping should
be skipped for the 4KB pages having MSI-X table.</p>
<p>There are three situations for the emulation of MSI-X table:</p>
<ul class="simple">
<li><strong>Service VM</strong>: accesses to MSI-X table are handled by HV MMIO handler (4KB adjusted up
and down). HV will remap interrupts.</li>
<li><strong>Post-launched VM</strong>: accesses to MSI-X Tables are handled by DM MMIO handler
(4KB adjusted up and down) and when DM (Service VM) writes to the table, it will be
intercepted by HV MMIO handler and HV will remap interrupts.</li>
<li><strong>Pre-launched VM</strong>: Writes to MMIO region in MSI-X Table BAR handled by HV MMIO
handler. If the offset falls within the MSI-X table (offset, offset+tables_size),
HV remaps interrupts.</li>
</ul>
</div>
<div class="section" id="interrupt-remapping">
<span id="id1"></span><h2>Interrupt Remapping<a class="headerlink" href="#interrupt-remapping" title="Permalink to this headline">¶</a></h2>
<p>When the physical interrupt of a passthrough device happens, hypervisor has
to distribute it to the relevant VM according to interrupt remapping
relationships. The structure <code class="docutils literal notranslate"><span class="pre">ptirq_remapping_info</span></code> is used to define
the subordination relation between physical interrupt and VM, the
virtual destination, etc. See the following figure for details:</p>
<div class="figure align-center" id="id6">
<img alt="../../_images/passthru-image91.png" src="../../_images/passthru-image91.png" />
<p class="caption"><span class="caption-number">Figure 202 </span><span class="caption-text">Remapping of physical interrupts</span></p>
</div>
<p>There are two different types of interrupt source: IOAPIC and MSI.
The hypervisor will record different information for interrupt
distribution: physical and virtual IOAPIC pin for IOAPIC source,
physical and virtual BDF and other info for MSI source.</p>
<p>Service VM passthrough is also in the scope of interrupt remapping which is
done on-demand rather than on hypervisor initialization.</p>
<div class="figure align-center" id="init-remapping">
<img alt="../../_images/passthru-image102.png" src="../../_images/passthru-image102.png" />
<p class="caption"><span class="caption-number">Figure 203 </span><span class="caption-text">Initialization of remapping of virtual IOAPIC interrupts for Service VM</span></p>
</div>
<p><a class="reference internal" href="#init-remapping"><span class="std std-numref">Figure 203</span></a> above illustrates how remapping of (virtual) IOAPIC
interrupts are remapped for Service VM. VM exit occurs whenever Service VM tries to
unmask an interrupt in (virtual) IOAPIC by writing to the Redirection
Table Entry (or RTE). The hypervisor then invokes the IOAPIC emulation
handler (refer to <a class="reference internal" href="hv-io-emulation.html#hld-io-emulation"><span class="std std-ref">I/O Emulation high-level design</span></a> for details on I/O emulation) which
calls APIs to set up a remapping for the to-be-unmasked interrupt.</p>
<p>Remapping of (virtual) PIC interrupts are set up in a similar sequence:</p>
<div class="figure align-center" id="id7">
<img alt="../../_images/passthru-image98.png" src="../../_images/passthru-image98.png" />
<p class="caption"><span class="caption-number">Figure 204 </span><span class="caption-text">Initialization of remapping of virtual MSI for Service VM</span></p>
</div>
<p>This figure illustrates how mappings of MSI or MSI-X are set up for
Service VM. Service VM is responsible for issuing a hypercall to notify the
hypervisor before it configures the PCI configuration space to enable an
MSI. The hypervisor takes this opportunity to set up a remapping for the
given MSI or MSI-X before it is actually enabled by Service VM.</p>
<p>When the User VM needs to access the physical device by passthrough, it uses
the following steps:</p>
<ul class="simple">
<li>User VM gets a virtual interrupt</li>
<li>VM exit happens and the trapped vCPU is the target where the interrupt
will be injected.</li>
<li>Hypervisor will handle the interrupt and translate the vector
according to ptirq_remapping_info.</li>
<li>Hypervisor delivers the interrupt to User VM.</li>
</ul>
<p>When the Service VM needs to use the physical device, the passthrough is also
active because the Service VM is the first VM. The detail steps are:</p>
<ul class="simple">
<li>Service VM get all physical interrupts. It assigns different interrupts for
different VMs during initialization and reassign when a VM is created or
deleted.</li>
<li>When physical interrupt is trapped, an exception will happen after VMCS
has been set.</li>
<li>Hypervisor will handle the VM exit issue according to
ptirq_remapping_info and translates the vector.</li>
<li>The interrupt will be injected the same as a virtual interrupt.</li>
</ul>
</div>
<div class="section" id="acpi-virtualization">
<h2>ACPI Virtualization<a class="headerlink" href="#acpi-virtualization" title="Permalink to this headline">¶</a></h2>
<p>ACPI virtualization is designed in ACRN with these assumptions:</p>
<ul class="simple">
<li>HV has no knowledge of ACPI,</li>
<li>Service VM owns all physical ACPI resources,</li>
<li>User VM sees virtual ACPI resources emulated by device model.</li>
</ul>
<p>Some passthrough devices require physical ACPI table entry for
initialization. The device model will create such device entry based on
the physical one according to vendor ID and device ID. Virtualization is
implemented in Service VM device model and not in scope of the hypervisor.
For pre-launched VM, ACRN hypervisor doesn’t support the ACPI virtualization,
so devices relying on ACPI table are not supported.</p>
</div>
<div class="section" id="gsi-sharing-violation-check">
<h2>GSI Sharing Violation Check<a class="headerlink" href="#gsi-sharing-violation-check" title="Permalink to this headline">¶</a></h2>
<p>All the PCI devices that are sharing the same GSI should be assigned to
the same VM to avoid physical GSI sharing between multiple VMs.
In logical partition mode or hybrid mode, the PCI devices assigned to
pre-launched VM is statically pre-defined. Developers should take care not to
violate the rule.
For post-launched VM, devices that don’t support MSI, ACRN DM puts the devices
sharing the same GSI pin to a GSI
sharing group. The devices in the same group should be assigned together to
the current VM, otherwise, none of them should be assigned to the
current VM. A device that violates the rule will be rejected to be
passed-through. The checking logic is implemented in Device Model and not
in scope of hypervisor.
The platform GSI information is in devicemodel/hw/pci/platform_gsi_info.c
for limited platform (currently, only APL MRB). For other platforms, the platform
specific GSI information should be added to activate the checking of GSI sharing violation.</p>
</div>
<div class="section" id="data-structures-and-interfaces">
<h2>Data structures and interfaces<a class="headerlink" href="#data-structures-and-interfaces" title="Permalink to this headline">¶</a></h2>
<p>The following APIs are common APIs provided to initialize interrupt remapping for
VMs:</p>
<dl class="function">
<dt id="_CPPv320ptirq_intx_pin_remapP7acrn_vm8uint32_t9intx_ctlr">
<span id="_CPPv220ptirq_intx_pin_remapP7acrn_vm8uint32_t9intx_ctlr"></span><span id="ptirq_intx_pin_remap__acrn_vmP.uint32_t.intx_ctlr"></span><span class="target" id="group__acrn__passthrough_ga73c49100a892a4a7ee0e61feafaa2e6f_1ga73c49100a892a4a7ee0e61feafaa2e6f"></span>int32_t <code class="descname">ptirq_intx_pin_remap</code><span class="sig-paren">(</span><em class="property">struct</em> acrn_vm *<em>vm</em>, uint32_t <em>virt_gsi</em>, <em class="property">enum</em> intx_ctlr <em>vgsi_ctlr</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv320ptirq_intx_pin_remapP7acrn_vm8uint32_t9intx_ctlr" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>INTx remapping for passthrough device. </p>
<p>Set up the remapping of the given virtual pin for the given vm. This is the main entry for PCI/Legacy device assignment with INTx, calling from vIOAPIC or vPIC.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><ul class="simple">
<li>0: on success</li>
<li><code class="docutils literal notranslate"><span class="pre">-ENODEV</span></code>:<ul>
<li>for SOS, the entry already be held by others</li>
<li>for UOS, no pre-hold mapping found.</li>
</ul>
</li>
</ul>
</dd>
<dt><strong>Preconditions</strong></dt>
<dd>vm != NULL </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">vm</span></code>: pointer to acrn_vm </li>
<li><code class="docutils literal notranslate"><span class="pre">virt_gsi</span></code>: virtual GSI number associated with the passthrough device </li>
<li><code class="docutils literal notranslate"><span class="pre">vgsi_ctlr</span></code>: INTX_CTLR_IOAPIC or INTX_CTLR_PIC</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv324ptirq_prepare_msix_remapP7acrn_vm8uint16_t8uint16_t8uint16_tP8msi_info8uint16_t">
<span id="_CPPv224ptirq_prepare_msix_remapP7acrn_vm8uint16_t8uint16_t8uint16_tP8msi_info8uint16_t"></span><span id="ptirq_prepare_msix_remap__acrn_vmP.uint16_t.uint16_t.uint16_t.msi_infoP.uint16_t"></span><span class="target" id="group__acrn__passthrough_gaf08b6e402e371fe2dda7e10d901d41b1_1gaf08b6e402e371fe2dda7e10d901d41b1"></span>int32_t <code class="descname">ptirq_prepare_msix_remap</code><span class="sig-paren">(</span><em class="property">struct</em> acrn_vm *<em>vm</em>, uint16_t <em>virt_bdf</em>, uint16_t <em>phys_bdf</em>, uint16_t <em>entry_nr</em>, <em class="property">struct</em> msi_info *<em>info</em>, uint16_t <em>irte_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv324ptirq_prepare_msix_remapP7acrn_vm8uint16_t8uint16_t8uint16_tP8msi_info8uint16_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>MSI/MSI-x remapping for passthrough device. </p>
<p>Main entry for PCI device assignment with MSI and MSI-X. MSI can up to 8 vectors and MSI-X can up to 1024 Vectors.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><ul class="simple">
<li>0: on success</li>
<li><code class="docutils literal notranslate"><span class="pre">-ENODEV</span></code>:<ul>
<li>for SOS, the entry already be held by others</li>
<li>for UOS, no pre-hold mapping found.</li>
</ul>
</li>
</ul>
</dd>
<dt><strong>Preconditions</strong></dt>
<dd>vm != NULL </dd>
<dt><strong>Preconditions</strong></dt>
<dd>info != NULL </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">vm</span></code>: pointer to acrn_vm </li>
<li><code class="docutils literal notranslate"><span class="pre">virt_bdf</span></code>: virtual bdf associated with the passthrough device </li>
<li><code class="docutils literal notranslate"><span class="pre">phys_bdf</span></code>: virtual bdf associated with the passthrough device </li>
<li><code class="docutils literal notranslate"><span class="pre">entry_nr</span></code>: indicate coming vectors, entry_nr = 0 means first vector </li>
<li><code class="docutils literal notranslate"><span class="pre">info</span></code>: structure used for MSI/MSI-x remapping </li>
<li><code class="docutils literal notranslate"><span class="pre">irte_idx</span></code>: caller can pass a valid IRTE index, otherwise, use INVALID_IRTE_ID</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<p>Post-launched VM needs to pre-allocate interrupt entries during VM initialization.
Post-launched VM needs to free interrupt entries during VM de-initialization.
The following APIs are provided to pre-allocate/free interrupt entries for post-launched VM:</p>
<dl class="function">
<dt id="_CPPv324ptirq_add_intx_remappingP7acrn_vm8uint32_t8uint32_tb">
<span id="_CPPv224ptirq_add_intx_remappingP7acrn_vm8uint32_t8uint32_tb"></span><span id="ptirq_add_intx_remapping__acrn_vmP.uint32_t.uint32_t.b"></span><span class="target" id="group__acrn__passthrough_ga0095f3f4399e3409aa087b49b4625052_1ga0095f3f4399e3409aa087b49b4625052"></span>int32_t <code class="descname">ptirq_add_intx_remapping</code><span class="sig-paren">(</span><em class="property">struct</em> acrn_vm *<em>vm</em>, uint32_t <em>virt_gsi</em>, uint32_t <em>phys_gsi</em>, bool <em>pic_pin</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv324ptirq_add_intx_remappingP7acrn_vm8uint32_t8uint32_tb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add an interrupt remapping entry for INTx as pre-hold mapping. </p>
<p>Except sos_vm, Device Model should call this function to pre-hold ptdev intx The entry is identified by phys_pin, one entry vs. one phys_pin. Currently, one phys_pin can only be held by one pin source (vPIC or vIOAPIC).</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><ul class="simple">
<li>0: on success</li>
<li><code class="docutils literal notranslate"><span class="pre">-EINVAL</span></code>: invalid virt_pin value</li>
<li><code class="docutils literal notranslate"><span class="pre">-ENODEV</span></code>: failed to add the remapping entry</li>
</ul>
</dd>
<dt><strong>Preconditions</strong></dt>
<dd>vm != NULL </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">vm</span></code>: pointer to acrn_vm </li>
<li><code class="docutils literal notranslate"><span class="pre">virt_gsi</span></code>: virtual pin number associated with the passthrough device </li>
<li><code class="docutils literal notranslate"><span class="pre">phys_gsi</span></code>: physical pin number associated with the passthrough device </li>
<li><code class="docutils literal notranslate"><span class="pre">pic_pin</span></code>: true for pic, false for ioapic</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv327ptirq_remove_intx_remappingPK7acrn_vm8uint32_tb">
<span id="_CPPv227ptirq_remove_intx_remappingPK7acrn_vm8uint32_tb"></span><span id="ptirq_remove_intx_remapping__acrn_vmCP.uint32_t.b"></span><span class="target" id="group__acrn__passthrough_ga62bc1681944903b329ffbe2d4f28dab6_1ga62bc1681944903b329ffbe2d4f28dab6"></span>void <code class="descname">ptirq_remove_intx_remapping</code><span class="sig-paren">(</span><em class="property">const</em> <em class="property">struct</em> acrn_vm *<em>vm</em>, uint32_t <em>virt_gsi</em>, bool <em>pic_pin</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv327ptirq_remove_intx_remappingPK7acrn_vm8uint32_tb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Remove an interrupt remapping entry for INTx. </p>
<p>Deactivate &amp; remove mapping entry of the given virt_pin for given vm.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>None</dd>
<dt><strong>Preconditions</strong></dt>
<dd>vm != NULL </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">vm</span></code>: pointer to acrn_vm </li>
<li><code class="docutils literal notranslate"><span class="pre">virt_gsi</span></code>: virtual pin number associated with the passthrough device </li>
<li><code class="docutils literal notranslate"><span class="pre">pic_pin</span></code>: true for pic, false for ioapic</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv327ptirq_remove_msix_remappingPK7acrn_vm8uint16_t8uint32_t">
<span id="_CPPv227ptirq_remove_msix_remappingPK7acrn_vm8uint16_t8uint32_t"></span><span id="ptirq_remove_msix_remapping__acrn_vmCP.uint16_t.uint32_t"></span><span class="target" id="group__acrn__passthrough_gaaed5116dffd86bf1298da9b77cc8cd4d_1gaaed5116dffd86bf1298da9b77cc8cd4d"></span>void <code class="descname">ptirq_remove_msix_remapping</code><span class="sig-paren">(</span><em class="property">const</em> <em class="property">struct</em> acrn_vm *<em>vm</em>, uint16_t <em>phys_bdf</em>, uint32_t <em>vector_count</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv327ptirq_remove_msix_remappingPK7acrn_vm8uint16_t8uint32_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Remove interrupt remapping entry/entries for MSI/MSI-x. </p>
<p>Remove the mapping of given number of vectors of the given virtual BDF for the given vm.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>None</dd>
<dt><strong>Preconditions</strong></dt>
<dd>vm != NULL </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">vm</span></code>: pointer to acrn_vm </li>
<li><code class="docutils literal notranslate"><span class="pre">phys_bdf</span></code>: physical bdf associated with the passthrough device </li>
<li><code class="docutils literal notranslate"><span class="pre">vector_count</span></code>: number of vectors</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<p>The following APIs are provided to acknowledge a virtual interrupt.</p>
<dl class="function">
<dt id="_CPPv314ptirq_intx_ackP7acrn_vm8uint32_t9intx_ctlr">
<span id="_CPPv214ptirq_intx_ackP7acrn_vm8uint32_t9intx_ctlr"></span><span id="ptirq_intx_ack__acrn_vmP.uint32_t.intx_ctlr"></span><span class="target" id="group__acrn__passthrough_gae456b1c1e9b19d920f15c7392e93dbd6_1gae456b1c1e9b19d920f15c7392e93dbd6"></span>void <code class="descname">ptirq_intx_ack</code><span class="sig-paren">(</span><em class="property">struct</em> acrn_vm *<em>vm</em>, uint32_t <em>virt_gsi</em>, <em class="property">enum</em> intx_ctlr <em>vgsi_ctlr</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv314ptirq_intx_ackP7acrn_vm8uint32_t9intx_ctlr" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Acknowledge a virtual interrupt for passthrough device. </p>
<p>Acknowledge a virtual legacy interrupt for a passthrough device.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>None</dd>
<dt><strong>Preconditions</strong></dt>
<dd>vm != NULL </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">vm</span></code>: pointer to acrn_vm </li>
<li><code class="docutils literal notranslate"><span class="pre">virt_gsi</span></code>: virtual GSI number associated with the passthrough device </li>
<li><code class="docutils literal notranslate"><span class="pre">vgsi_ctlr</span></code>: INTX_CTLR_IOAPIC or INTX_CTLR_PIC</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<p>The following APIs are provided to handle ptdev interrupt:</p>
<dl class="function">
<dt id="_CPPv310ptdev_initv">
<span id="_CPPv210ptdev_initv"></span><span id="ptdev_init__void"></span><span class="target" id="group__acrn__passthrough_ga17303a9f08f5090e75d4fbafb2ced67a_1ga17303a9f08f5090e75d4fbafb2ced67a"></span>void <code class="descname">ptdev_init</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv310ptdev_initv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Passthrough device global data structure initialization. </p>
<p>During the hypervisor cpu initialization stage, this function:<ul class="simple">
<li>init global spinlock for ptdev (on BSP)</li>
<li>register SOFTIRQ_PTDEV handler (on BSP)</li>
<li>init the softirq entry list for each CPU </li>
</ul>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv313ptirq_softirq8uint16_t">
<span id="_CPPv213ptirq_softirq8uint16_t"></span><span id="ptirq_softirq__uint16_t"></span><span class="target" id="group__acrn__passthrough_gaefcabcb82488fce2a18f6b5ab9dacd2c_1gaefcabcb82488fce2a18f6b5ab9dacd2c"></span>void <code class="descname">ptirq_softirq</code><span class="sig-paren">(</span>uint16_t <em>pcpu_id</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv313ptirq_softirq8uint16_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handler of softirq for passthrough device. </p>
<p>When hypervisor receive a physical interrupt from passthrough device, it will enqueue a ptirq entry and raise softirq SOFTIRQ_PTDEV. This function is the handler of the softirq, it handles the interrupt and injects the virtual into VM. The handler is registered by calling <a class="reference internal" href="#group__acrn__passthrough_ga17303a9f08f5090e75d4fbafb2ced67a_1ga17303a9f08f5090e75d4fbafb2ced67a"><span class="std std-ref">ptdev_init</span></a> during hypervisor initialization.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">pcpu_id</span></code>: physical cpu id of the soft irq </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv317ptirq_alloc_entryP7acrn_vm8uint32_t">
<span id="_CPPv217ptirq_alloc_entryP7acrn_vm8uint32_t"></span><span id="ptirq_alloc_entry__acrn_vmP.uint32_t"></span><span class="target" id="group__acrn__passthrough_ga4aa69d188bfee801e4f26f1611bc7b54_1ga4aa69d188bfee801e4f26f1611bc7b54"></span><em class="property">struct</em> ptirq_remapping_info *<code class="descname">ptirq_alloc_entry</code><span class="sig-paren">(</span><em class="property">struct</em> acrn_vm *<em>vm</em>, uint32_t <em>intr_type</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv317ptirq_alloc_entryP7acrn_vm8uint32_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate a ptirq_remapping_info entry. </p>
<p>Allocate a ptirq_remapping_info entry for hypervisor to store the remapping information. The total number of the entries is statically defined as CONFIG_MAX_PT_IRQ_ENTRIES. Appropriate number should be configured on different platforms.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">vm</span></code>: acrn_vm that the entry allocated for. </li>
<li><code class="docutils literal notranslate"><span class="pre">intr_type</span></code>: interrupt type: PTDEV_INTR_MSI or PTDEV_INTR_INTX</li>
</ul>
</dd>
<dt><strong>Return Value</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">NULL</span></code>: when the number of entries allocated is CONFIG_MAX_PT_IRQ_ENTRIES </li>
<li><code class="docutils literal notranslate"><span class="pre">!NULL</span></code>: when the number of entries allocated is less than CONFIG_MAX_PT_IRQ_ENTRIES </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv319ptirq_release_entryP20ptirq_remapping_info">
<span id="_CPPv219ptirq_release_entryP20ptirq_remapping_info"></span><span id="ptirq_release_entry__ptirq_remapping_infoP"></span><span class="target" id="group__acrn__passthrough_ga7431bb466468ae111721e6bac26b2870_1ga7431bb466468ae111721e6bac26b2870"></span>void <code class="descname">ptirq_release_entry</code><span class="sig-paren">(</span><em class="property">struct</em> ptirq_remapping_info *<em>entry</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv319ptirq_release_entryP20ptirq_remapping_info" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Release a ptirq_remapping_info entry. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">entry</span></code>: the ptirq_remapping_info entry to release. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv325ptdev_release_all_entriesPK7acrn_vm">
<span id="_CPPv225ptdev_release_all_entriesPK7acrn_vm"></span><span id="ptdev_release_all_entries__acrn_vmCP"></span><span class="target" id="group__acrn__passthrough_gac1a6ffabb25ac055ecb91d5e3d48b9e4_1gac1a6ffabb25ac055ecb91d5e3d48b9e4"></span>void <code class="descname">ptdev_release_all_entries</code><span class="sig-paren">(</span><em class="property">const</em> <em class="property">struct</em> acrn_vm *<em>vm</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv325ptdev_release_all_entriesPK7acrn_vm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Deactivate and release all ptirq entries for a VM. </p>
<p>This function deactivates and releases all ptirq entries for a VM. The function should only be called after the VM is already down.</p>
<p><dl class="docutils">
<dt><strong>Preconditions</strong></dt>
<dd>VM is already down </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">vm</span></code>: acrn_vm on which the ptirq entries will be released</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv320ptirq_activate_entryP20ptirq_remapping_info8uint32_t">
<span id="_CPPv220ptirq_activate_entryP20ptirq_remapping_info8uint32_t"></span><span id="ptirq_activate_entry__ptirq_remapping_infoP.uint32_t"></span><span class="target" id="group__acrn__passthrough_gaf47f3d6caec01ed87bba0b3b7b2bc729_1gaf47f3d6caec01ed87bba0b3b7b2bc729"></span>int32_t <code class="descname">ptirq_activate_entry</code><span class="sig-paren">(</span><em class="property">struct</em> ptirq_remapping_info *<em>entry</em>, uint32_t <em>phys_irq</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv320ptirq_activate_entryP20ptirq_remapping_info8uint32_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Activate a irq for the associated passthrough device. </p>
<p>After activating the ptirq entry, the physical interrupt irq of passthrough device will be handled by the handler ptirq_interrupt_handler.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">entry</span></code>: the ptirq_remapping_info entry that will be associated with the physical irq. </li>
<li><code class="docutils literal notranslate"><span class="pre">phys_irq</span></code>: physical interrupt irq for the entry</li>
</ul>
</dd>
<dt><strong>Return Value</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">success</span></code>: when return value &gt;=0 </li>
<li><code class="docutils literal notranslate"><span class="pre">failure</span></code>: when return value &lt; 0 </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv322ptirq_deactivate_entryP20ptirq_remapping_info">
<span id="_CPPv222ptirq_deactivate_entryP20ptirq_remapping_info"></span><span id="ptirq_deactivate_entry__ptirq_remapping_infoP"></span><span class="target" id="group__acrn__passthrough_ga2af2abdb38dac5c73d3b4158ee302bbe_1ga2af2abdb38dac5c73d3b4158ee302bbe"></span>void <code class="descname">ptirq_deactivate_entry</code><span class="sig-paren">(</span><em class="property">struct</em> ptirq_remapping_info *<em>entry</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv322ptirq_deactivate_entryP20ptirq_remapping_info" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>De-activate a irq for the associated passthrough device. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">entry</span></code>: the ptirq_remapping_info entry that will be de-activated. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv321ptirq_dequeue_softirq8uint16_t">
<span id="_CPPv221ptirq_dequeue_softirq8uint16_t"></span><span id="ptirq_dequeue_softirq__uint16_t"></span><span class="target" id="group__acrn__passthrough_gaf6878738c1ab8a47232b05fd05d7f61b_1gaf6878738c1ab8a47232b05fd05d7f61b"></span><em class="property">struct</em> ptirq_remapping_info *<code class="descname">ptirq_dequeue_softirq</code><span class="sig-paren">(</span>uint16_t <em>pcpu_id</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv321ptirq_dequeue_softirq8uint16_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Dequeue an entry from per cpu ptdev softirq queue. </p>
<p>Dequeue an entry from the ptdev softirq queue on the specific physical cpu.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">pcpu_id</span></code>: physical cpu id</li>
</ul>
</dd>
<dt><strong>Return Value</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">NULL</span></code>: when the queue is empty </li>
<li><code class="docutils literal notranslate"><span class="pre">!NULL</span></code>: when there is available ptirq_remapping_info entry in the queue </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv319ptirq_get_intr_dataPK7acrn_vmP8uint64_t8uint32_t">
<span id="_CPPv219ptirq_get_intr_dataPK7acrn_vmP8uint64_t8uint32_t"></span><span id="ptirq_get_intr_data__acrn_vmCP.uint64_tP.uint32_t"></span><span class="target" id="group__acrn__passthrough_gad6dce35a7aa78b0a2e02fae7f3594cfd_1gad6dce35a7aa78b0a2e02fae7f3594cfd"></span>uint32_t <code class="descname">ptirq_get_intr_data</code><span class="sig-paren">(</span><em class="property">const</em> <em class="property">struct</em> acrn_vm *<em>target_vm</em>, uint64_t *<em>buffer</em>, uint32_t <em>buffer_cnt</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv319ptirq_get_intr_dataPK7acrn_vmP8uint64_t8uint32_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get the interrupt information and store to the buffer provided. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">target_vm</span></code>: the VM to get the interrupt information. </li>
<li><code class="docutils literal notranslate"><span class="pre">buffer</span></code>: where interrupt information is stored. </li>
<li><code class="docutils literal notranslate"><span class="pre">buffer_cnt</span></code>: the size of the buffer.</li>
</ul>
</dd>
<dt><strong>Return Value</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">the</span></code>: actual size the buffer filled with the interrupt information </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Project ACRN
      <span class="lastupdated">
        Last updated on Nov 01, 2020.
      </span>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>