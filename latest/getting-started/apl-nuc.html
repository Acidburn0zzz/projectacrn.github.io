

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting started guide for Intel NUC &mdash; Project ACRN™ v 0.1-rc5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/ACRN-favicon-32x32.png"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/acrn-custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Getting started guide for UP2 board" href="up2.html" />
    <link rel="prev" title="Supported Hardware" href="hardware.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Project ACRN™
          

          
            
            <img src="../_static/ACRN_Logo_200w.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction to Project ACRN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#automotive-use-case-example">Automotive Use Case Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#licensing">Licensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#acrn-device-model-service-os-and-user-os">ACRN Device Model, Service OS, and User OS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#boot-sequence">Boot Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#acrn-hypervisor-architecture">ACRN Hypervisor Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#acrn-device-model-architecture">ACRN Device Model Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#device-pass-through">Device pass through</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/index.html#hardware-support-for-device-passthrough">Hardware support for device passthrough</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/index.html#hypervisor-support-for-device-passthrough">Hypervisor support for device passthrough</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#acrn-i-o-mediator">ACRN I/O mediator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#virtio-framework-architecture">Virtio framework architecture</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hardware.html">Supported Hardware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hardware.html#intel-apollo-lake-nuc">Intel Apollo Lake NUC</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware.html#up-squared-board">UP Squared board</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Getting started guide for Intel NUC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hardware-setup">Hardware setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#firmware-update-on-the-nuc">Firmware update on the NUC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#software-setup">Software setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#set-up-a-clear-linux-operating-system">Set up a Clear Linux Operating System</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-the-acrn-hypervisor-to-the-efi-partition">Add the ACRN hypervisor to the EFI Partition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acrn-network-bridge">ACRN Network Bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-up-reference-uos">Set up Reference UOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-manager-memory-allocation-mechanism">Device Manager memory allocation mechanism</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#build-acrn-from-source">Build ACRN from Source</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#install-build-tools-and-dependencies">Install build tools and dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-the-hypervisor-device-model-and-tools">Build the hypervisor, device model and tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-the-hypervisor-configurations">Generate the hypervisor configurations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modify-the-hypervisor-configurations">Modify the hypervisor configurations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-a-new-default-configuration">Create a new default configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="up2.html">Getting started guide for UP2 board</a><ul>
<li class="toctree-l3"><a class="reference internal" href="up2.html#hardware-setup">Hardware setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="up2.html#connecting-to-the-serial-port">Connecting to the serial port</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="up2.html#software-setup">Software setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="up2.html#up2-serial-port-setting">UP2 serial port setting</a></li>
<li class="toctree-l4"><a class="reference internal" href="up2.html#up2-block-device">UP2 block device</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="up2.html#running-the-hypervisor">Running the hypervisor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user-guides/index.html">User Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user-guides/acrn-shell.html">ACRN Shell Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user-guides/tools.html">Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/acrn-crashlog/README.html">ACRN-Crashlog</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/README.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/README.html#building">Building</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/README.html#installing">Installing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/README.html#source-code">Source Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/acrn-crashlog/acrnprobe/README.html">Acrnprobe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/acrnprobe/README.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/acrnprobe/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/acrnprobe/README.html#architecture">Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/acrnprobe/README.html#source-files">Source files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/acrnprobe/README.html#configuration-files">Configuration files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/acrn-crashlog/usercrash/README.html">Usercrash</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/usercrash/README.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/usercrash/README.html#design">Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/usercrash/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-crashlog/usercrash/README.html#souce-code">Souce Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/acrn-manager/README.html">acrnctl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-manager/README.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-manager/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrn-manager/README.html#build-and-install">Build and Install</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/acrnlog/README.html">acrnlog</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrnlog/README.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrnlog/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrnlog/README.html#build-and-install">Build and Install</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/acrntrace/README.html">acrntrace</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrntrace/README.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrntrace/README.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/acrntrace/README.html#build-and-install">Build and Install</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer-guides/index.html">Developer Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer-guides/primer.html">Developer Primer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/primer.html#source-tree-structure">Source Tree Structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#acrn-hypervisor-source-tree">ACRN hypervisor source tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#acrn-device-model-source-tree">ACRN Device Model source tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#acrn-tools-source-tree">ACRN Tools source tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#acrn-documentation-source-tree">ACRN documentation source tree</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/primer.html#cpu-virtualization">CPU virtualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#host-gdt">Host GDT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#host-idt">Host IDT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#guest-smp-booting">Guest SMP Booting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#vmx-configuration">VMX configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#cpuid-and-guest-tsc-calibration">CPUID and Guest TSC calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#rdtsc-rdtscp">RDTSC/RDTSCP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#cr-register-virtualization">CR Register virtualization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#msr-bitmap">MSR BITMAP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#i-o-bitmap">I/O BITMAP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#exceptions">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/primer.html#memory-virtualization">Memory virtualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#physical-memory-layout">Physical Memory Layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#pv-mmu-memory-mapping-in-the-hypervisor">PV (MMU) Memory Mapping in the Hypervisor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#pv-mmu-memory-mapping-in-vms">PV (MMU) Memory Mapping in VMs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#host-guest-ept-memory-mapping">Host-Guest (EPT) Memory Mapping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/primer.html#graphic-mediation">Graphic mediation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/primer.html#i-o-emulation">I/O emulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#device-assignment-management">Device Assignment Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#pio-mmio-trap-flow">PIO/MMIO trap Flow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/primer.html#virtual-interrupt">Virtual interrupt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#virtual-lapic">Virtual LAPIC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#virtual-ioapic">Virtual IOAPIC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#virtual-pic">Virtual PIC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#virtual-interrupt-injection">Virtual Interrupt Injection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/primer.html#vt-x-and-vt-d">VT-x and VT-d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/primer.html#hypercall">Hypercall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/primer.html#device-emulation">Device emulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/primer.html#virtio-devices">Virtio Devices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#virtio-rnd">Virtio-rnd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#virtio-blk">Virtio-blk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#virtio-net">Virtio-net</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/primer.html#virtio-console">Virtio-console</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html">API Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/hypercall_api.html">Hypercall APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/devicemodel_api.html">Device Model APIs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/kconfig/index.html">Configuration Symbol Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/kconfig/index.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/kconfig/index.html#supported-options">Supported Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer-guides/index.html#contributing-to-the-project">Contributing to the project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/contribute_guidelines.html">Contribution Guidelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/contribute_guidelines.html#licensing">Licensing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/contribute_guidelines.html#developer-certification-of-origin-dco">Developer Certification of Origin (DCO)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/contribute_guidelines.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/contribute_guidelines.html#repository-layout">Repository layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/contribute_guidelines.html#submitting-issues">Submitting Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/contribute_guidelines.html#contribution-tools-and-git-setup">Contribution Tools and Git Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/contribute_guidelines.html#coding-style">Coding Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/contribute_guidelines.html#contribution-workflow">Contribution Workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/contribute_guidelines.html#commit-guidelines">Commit Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/doc_guidelines.html">Documentation Guidelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/doc_guidelines.html#headings">Headings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/doc_guidelines.html#content-highlighting">Content Highlighting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/doc_guidelines.html#lists">Lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/doc_guidelines.html#multi-column-lists">Multi-column lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/doc_guidelines.html#file-names-and-commands">File names and Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/doc_guidelines.html#internal-cross-reference-linking">Internal Cross-Reference Linking</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/doc_guidelines.html#non-ascii-characters">Non-ASCII Characters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/doc_guidelines.html#code-and-command-examples">Code and Command Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/doc_guidelines.html#tabs-spaces-and-indenting">Tabs, spaces, and indenting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/doc_guidelines.html#drawings">Drawings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developer-guides/graphviz.html">Drawings using graphviz</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/graphviz.html#simple-directed-graph">Simple directed graph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/graphviz.html#adding-edge-labels">Adding edge labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/graphviz.html#tables">Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer-guides/graphviz.html#finite-state-machine">Finite-State Machine</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/docbuild.html">ACRN documentation generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/docbuild.html#documentation-overview">Documentation overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/docbuild.html#set-up-the-documentation-working-folders">Set up the documentation working folders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/docbuild.html#installing-the-documentation-tools">Installing the documentation tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/docbuild.html#documentation-presentation-theme">Documentation presentation theme</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/docbuild.html#running-the-documentation-processors">Running the documentation processors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/docbuild.html#publishing-content">Publishing content</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/docbuild.html#filtering-expected-warnings">Filtering expected warnings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/static-ip.html">Using a static IP address</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/static-ip.html#acrn-network-setup">ACRN Network Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/static-ip.html#setting-up-the-static-ip-address">Setting up the static IP address</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/static-ip.html#activate-the-new-configuration">Activate the new configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release_notes.html#version-0-1-release-march-2018">Version 0.1 release (March 2018)</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Project ACRN™</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Getting Started Guides</a> &raquo;</li>
        
      <li>Getting started guide for Intel NUC</li>
    
    

<li class="wy-breadcrumbs-aside">
   <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
      <span class="rst-current-version" data-toggle="rst-current-version">
         <span class="fa fa-book"> Project ACRN</span>
         version: latest
         <span class="fa fa-caret-down"></span>
      </span>
      <div class="rst-other-versions">
         <dl>
            <dt>Versions</dt>
               
               <dd><a href="/latest/">latest</a></dd>
              
         </dl>
      </div>
   </div>
</li>


  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-started-guide-for-intel-nuc">
<span id="getting-started-apl-nuc"></span><h1>Getting started guide for Intel NUC<a class="headerlink" href="#getting-started-guide-for-intel-nuc" title="Permalink to this headline">¶</a></h1>
<p>The Intel® NUC (NUC6CAYH) is the primary tested
platform for ACRN development, and its setup is described below.</p>
<div class="section" id="hardware-setup">
<h2>Hardware setup<a class="headerlink" href="#hardware-setup" title="Permalink to this headline">¶</a></h2>
<p>Two Apollo Lake Intel platforms, described in <a class="reference internal" href="hardware.html#hardware"><span class="std std-ref">Supported Hardware</span></a>, are currently
supported for ACRN development:</p>
<ul class="simple">
<li>The <a class="reference external" href="http://www.up-board.org/upsquared/">UP Squared board</a> (UP2) is also
known to work and its setup is described in <a class="reference internal" href="up2.html#getting-started-up2"><span class="std std-ref">Getting started guide for UP2 board</span></a>.</li>
</ul>
<div class="section" id="firmware-update-on-the-nuc">
<h3>Firmware update on the NUC<a class="headerlink" href="#firmware-update-on-the-nuc" title="Permalink to this headline">¶</a></h3>
<p>You may need to update to the latest UEFI firmware for the NUC hardware.
Follow these <a class="reference external" href="https://www.intel.com/content/www/us/en/support/articles/000005636.html">BIOS Update Instructions</a>
for downloading and flashing an updated BIOS for the NUC.</p>
</div>
</div>
<div class="section" id="software-setup">
<h2>Software setup<a class="headerlink" href="#software-setup" title="Permalink to this headline">¶</a></h2>
<div class="section" id="set-up-a-clear-linux-operating-system">
<h3>Set up a Clear Linux Operating System<a class="headerlink" href="#set-up-a-clear-linux-operating-system" title="Permalink to this headline">¶</a></h3>
<p>Currently, an installable version of ARCN does not exist. Therefore, you
need to setup a base Clear Linux OS and you’ll build and bootstrap ACRN
on your platform. You’ll need a network connection for your platform to
complete this setup.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ACRN requires Clear Linux version 22140 or newer. The instructions below
have been validated with version 22140 and need some adjustment to work
with newer versions. You will see a note when the instruction needs to be
adjusted.</p>
</div>
<ol class="arabic">
<li><p class="first">Download the compressed Clear installer image from
<a class="reference external" href="https://download.clearlinux.org/releases/22140/clear/clear-22140-installer.img.xz">https://download.clearlinux.org/releases/22140/clear/clear-22140-installer.img.xz</a>
and follow the <a class="reference external" href="https://clearlinux.org/documentation/clear-linux/get-started/bare-metal-install">Clear Linux installation guide</a>
as a starting point for installing Clear Linux onto your platform.  Follow the recommended
options for choosing an <strong>Automatic</strong> installation type, and using the platform’s
storage as the target device for installation (overwriting the existing data
and creating three partitions on the platform’s storage drive).</p>
</li>
<li><p class="first">After installation is complete, boot into Clear Linux, login as
<strong>root</strong>, and set a password.</p>
</li>
<li><p class="first">Clear Linux is set to automatically update itself. We recommend that you disable
this feature to have more control over when the updates happen. Use this command
to disable the autoupdate feature:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># swupd autoupdate --disable
</pre></div>
</div>
</li>
<li><p class="first">Use the <code class="docutils literal notranslate"><span class="pre">swupd</span> <span class="pre">bundle-add</span></code> command and add these Clear Linux bundles:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># swupd bundle-add vim network-basic service-os kernel-pk
</pre></div>
</div>
<table border="1" class="colwidths-auto docutils" id="cl-bundles">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Clear Linux bundles</span><a class="headerlink" href="#cl-bundles" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Bundle</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>vim</td>
<td>vim text editor</td>
</tr>
<tr class="row-odd"><td>network-basic</td>
<td>Run network utilities and modify network settings</td>
</tr>
<tr class="row-even"><td>service-os</td>
<td>Add the acrn hypervisor, the acrn devicemodel and
Service OS kernel</td>
</tr>
<tr class="row-odd"><td>kernel-pk</td>
<td>Run the Intel “PK” kernel(product kernel source)
and enterprise-style kernel with backports</td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
<div class="section" id="add-the-acrn-hypervisor-to-the-efi-partition">
<h3>Add the ACRN hypervisor to the EFI Partition<a class="headerlink" href="#add-the-acrn-hypervisor-to-the-efi-partition" title="Permalink to this headline">¶</a></h3>
<p>In order to boot the ACRN SOS on the platform, you’ll need to add it to the EFI
partition. Follow these steps:</p>
<ol class="arabic">
<li><p class="first">Mount the EFI partition and verify you have the following files:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># mount /dev/sda1 /mnt

# ls -1 /mnt/EFI/org.clearlinux
bootloaderx64.efi
kernel-org.clearlinux.native.4.16.6-563
kernel-org.clearlinux.pk414-sos.4.14.34-28
kernel-org.clearlinux.pk414-standard.4.14.34-28
loaderx64.efi
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Clear Linux project releases updates often, sometimes
twice a day, so make note of the specific kernel versions (<code class="docutils literal notranslate"><span class="pre">*-sos</span></code>
and <code class="docutils literal notranslate"><span class="pre">*-standard</span></code>) listed on your system,
as you will need them later.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The EFI System Partition (ESP) may be different based on your hardware.
It will typically be something like <code class="docutils literal notranslate"><span class="pre">/dev/mmcblk0p1</span></code> on platforms
that have an on-board eMMC or <code class="docutils literal notranslate"><span class="pre">/dev/nvme0n1p1</span></code> if your system has
a non-volatile storage media attached via a PCI Express (PCIe) bus
(NVMe).</p>
</div>
</li>
<li><p class="first">Put the <code class="docutils literal notranslate"><span class="pre">acrn.efi</span></code> hypervisor application (included in the Clear
Linux release) on the EFI partition with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># mkdir /mnt/EFI/acrn
# cp /usr/lib/acrn/acrn.efi /mnt/EFI/acrn/
</pre></div>
</div>
</li>
<li><p class="first">Configure the EFI firmware to boot the ACRN hypervisor by default</p>
<p>The ACRN hypervisor (<code class="docutils literal notranslate"><span class="pre">acrn.efi</span></code>) is an EFI executable
loaded directly by the platform EFI firmware. It then in turns loads the
Service OS bootloader. Use the <code class="docutils literal notranslate"><span class="pre">efibootmgr</span></code> utility to configure the EFI
firmware and add a new entry that loads the ACRN hypervisor.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># efibootmgr -c -l &quot;\EFI\acrn\acrn.efi&quot; -d /dev/sda -p 1 -L ACRN
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Be aware that a Clearlinux update that includes a kernel upgrade will
reset the boot option changes you just made. A Clearlinux update could
happen automatically (if you have not disabled it as described above),
if you later install a new bundle to your system, or simply if you
decide to trigger an update manually. Whenever that happens,
double-check the platform boot order using <code class="docutils literal notranslate"><span class="pre">efibootmgr</span> <span class="pre">-v</span></code> and
modify it if needed.</p>
</div>
<p>The ACRN hypervisor (<code class="docutils literal notranslate"><span class="pre">acrn.efi</span></code>) accepts two command-line parameters that
tweak its behaviour:</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">bootloader=</span></code>: this sets the EFI executable to be loaded once the hypervisor
is up and running. This is typically the bootloader of the Service OS and the
default value is to use the Clearlinux bootloader, i.e.:
<code class="docutils literal notranslate"><span class="pre">\EFI\org.clearlinux\bootloaderx64.efi</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">uart=</span></code>: this tells the hypervisor where the serial port (UART) is found or
whether it should be disabled. There are three forms for this parameter:<ol class="arabic">
<li><code class="docutils literal notranslate"><span class="pre">uart=disabled</span></code>: this disables the serial port completely</li>
<li><code class="docutils literal notranslate"><span class="pre">uart=mmio&#64;&lt;MMIO</span> <span class="pre">address&gt;</span></code>: this sets the serial port MMIO address</li>
<li><code class="docutils literal notranslate"><span class="pre">uart=port&#64;&lt;port</span> <span class="pre">address&gt;</span></code>: this sets the serial port address</li>
</ol>
</li>
</ol>
<p>Here is a more complete example of how to configure the EFI firmware to load the ACRN
hypervisor and set these parameters.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># efibootmgr -c -l &quot;\EFI\acrn\acrn.efi&quot; -d /dev/sda -p 1 -L &quot;ACRN Hypervisor&quot; \
      -u &quot;bootloader=\EFI\org.clearlinux\bootloaderx64.efi uart=mmio@0x9141e000&quot;
</pre></div>
</div>
</li>
<li><p class="first">Create a boot entry for the ACRN Service OS by copying a provided <code class="docutils literal notranslate"><span class="pre">acrn.conf</span></code>
and editing it to account for the kernel versions noted in a previous step.</p>
<p>It must contain these settings:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setting</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>title</td>
<td>Text to show in the boot menu</td>
</tr>
<tr class="row-odd"><td>linux</td>
<td>Linux kernel for the Service OS (*-sos)</td>
</tr>
<tr class="row-even"><td>options</td>
<td>Options to pass to the Service OS kernel (kernel parameters)</td>
</tr>
</tbody>
</table>
<p>A starter acrn.conf configuration file is included in the Clear Linux release and is
also available in the acrn-hypervisor/hypervisor GitHub repo as <a class="reference external" href="https://github.com/projectacrn/acrn-hypervisor/hypervisor/tree/master/bsp/uefi/clearlinux/acrn.conf">acrn.conf</a>
as shown here:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-number">Code Block 1 </span><span class="caption-text">hypervisor/bsp/uefi/clearlinux/acrn.conf</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="n">The</span> <span class="n">ACRN</span> <span class="n">Service</span> <span class="n">OS</span>
<span class="n">linux</span>   <span class="o">/</span><span class="n">EFI</span><span class="o">/</span><span class="n">org</span><span class="o">.</span><span class="n">clearlinux</span><span class="o">/</span><span class="n">kernel</span><span class="o">-</span><span class="n">org</span><span class="o">.</span><span class="n">clearlinux</span><span class="o">.</span><span class="n">pk414</span><span class="o">-</span><span class="n">sos</span><span class="o">.</span><span class="mf">4.14</span><span class="o">.</span><span class="mi">23</span><span class="o">-</span><span class="mi">19</span>
<span class="n">options</span> <span class="n">pci_devices_ignore</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="n">maxcpus</span><span class="o">=</span><span class="mi">1</span> <span class="n">console</span><span class="o">=</span><span class="n">tty0</span> <span class="n">console</span><span class="o">=</span><span class="n">ttyS0</span> <span class="n">i915</span><span class="o">.</span><span class="n">nuclear_pageflip</span><span class="o">=</span><span class="mi">1</span> <span class="n">root</span><span class="o">=</span><span class="n">PARTUUID</span><span class="o">=&lt;</span><span class="n">UUID</span> <span class="n">of</span> <span class="n">rootfs</span> <span class="n">partition</span><span class="o">&gt;</span> <span class="n">rw</span> <span class="n">rootwait</span> <span class="n">ignore_loglevel</span> <span class="n">no_timer_check</span> <span class="n">consoleblank</span><span class="o">=</span><span class="mi">0</span> <span class="n">i915</span><span class="o">.</span><span class="n">tsd_init</span><span class="o">=</span><span class="mi">7</span> <span class="n">i915</span><span class="o">.</span><span class="n">tsd_delay</span><span class="o">=</span><span class="mi">2000</span> <span class="n">i915</span><span class="o">.</span><span class="n">avail_planes_per_pipe</span><span class="o">=</span><span class="mh">0x01010F</span> <span class="n">i915</span><span class="o">.</span><span class="n">domain_plane_owners</span><span class="o">=</span><span class="mh">0x011111110000</span> <span class="n">i915</span><span class="o">.</span><span class="n">enable_guc_loading</span><span class="o">=</span><span class="mi">0</span> <span class="n">i915</span><span class="o">.</span><span class="n">enable_guc_submission</span><span class="o">=</span><span class="mi">0</span> <span class="n">i915</span><span class="o">.</span><span class="n">enable_preemption</span><span class="o">=</span><span class="mi">1</span> <span class="n">i915</span><span class="o">.</span><span class="n">context_priority_mode</span><span class="o">=</span><span class="mi">2</span> <span class="n">i915</span><span class="o">.</span><span class="n">enable_gvt</span><span class="o">=</span><span class="mi">1</span> <span class="n">i915</span><span class="o">.</span><span class="n">enable_initial_modeset</span><span class="o">=</span><span class="mi">1</span> <span class="n">hvlog</span><span class="o">=</span><span class="mi">2</span><span class="n">M</span><span class="nd">@0x1FE00000</span>
</pre></div>
</div>
</div>
<p>On the platform, copy the <code class="docutils literal notranslate"><span class="pre">acrn.conf</span></code> file to the EFI partition we mounted earlier:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># cp /usr/share/acrn/samples/nuc/acrn.conf /mnt/loader/entries/
</pre></div>
</div>
<p>You will need to edit this file to adjust the kernel version (<code class="docutils literal notranslate"><span class="pre">linux</span></code> section)
and also insert the <code class="docutils literal notranslate"><span class="pre">PARTUUID</span></code> of your <code class="docutils literal notranslate"><span class="pre">/dev/sda3</span></code> partition
(<code class="docutils literal notranslate"><span class="pre">root=PARTUUID=&lt;&gt;&lt;UUID</span> <span class="pre">of</span> <span class="pre">rootfs</span> <span class="pre">partition&gt;</span></code>) in the <code class="docutils literal notranslate"><span class="pre">options</span></code> section.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">blkid</span></code> to find out what your <code class="docutils literal notranslate"><span class="pre">/dev/sda3</span></code> <code class="docutils literal notranslate"><span class="pre">PARTUUID</span></code> value is.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is also possible to use the device name directly, e.g. <code class="docutils literal notranslate"><span class="pre">root=/dev/sda3</span></code></p>
</div>
</li>
<li><p class="first">Add a timeout period for Systemd-Boot to wait, otherwise it will not
present the boot menu and will always boot the base Clear Linux</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># clr-boot-manager set-timeout 20
# clr-boot-manager update
</pre></div>
</div>
</li>
<li><p class="first">Reboot and select “The ACRN Service OS” to boot, as shown in
<a class="reference internal" href="#gsg-bootmenu"><span class="std std-numref">Figure 11</span></a>:</p>
<div class="figure align-center" id="gsg-bootmenu">
<a class="reference internal image-reference" href="../_images/gsg-bootmenu.png"><img alt="../_images/gsg-bootmenu.png" src="../_images/gsg-bootmenu.png" style="width: 650px;" /></a>
<p class="caption"><span class="caption-number">Figure 11 </span><span class="caption-text">ACRN Service OS Boot menu</span></p>
</div>
</li>
<li><p class="first">After booting up the ACRN hypervisor, the Service OS will be launched
automatically by default, as shown in <a class="reference internal" href="#gsg-sos-console"><span class="std std-numref">Figure 12</span></a>:</p>
<div class="figure align-center" id="gsg-sos-console">
<img alt="../_images/gsg-sos-console.png" src="../_images/gsg-sos-console.png" />
<p class="caption"><span class="caption-number">Figure 12 </span><span class="caption-text">Service OS Console</span></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may need to hit <code class="docutils literal notranslate"><span class="pre">Enter</span></code> to get a clean login prompt</p>
</div>
</li>
<li><p class="first">From here you can login as root using the password you set previously when
you installed Clear Linux.</p>
</li>
</ol>
</div>
<div class="section" id="acrn-network-bridge">
<h3>ACRN Network Bridge<a class="headerlink" href="#acrn-network-bridge" title="Permalink to this headline">¶</a></h3>
<p>ACRN bridge has been setup as a part of systemd services for device communication. The default
bridge creates <code class="docutils literal notranslate"><span class="pre">acrn_br0</span></code> which is the bridge and <code class="docutils literal notranslate"><span class="pre">acrn_tap0</span></code> as an initial setup. The files can be
found in <code class="docutils literal notranslate"><span class="pre">/usr/lib/systemd/network</span></code>. No additional setup is needed since systemd-networkd is
automatically enabled after a system restart.</p>
</div>
<div class="section" id="set-up-reference-uos">
<h3>Set up Reference UOS<a class="headerlink" href="#set-up-reference-uos" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">On your platform, download the pre-built reference Clear Linux UOS image into your
(root) home directory:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># cd ~
# curl -O https://download.clearlinux.org/releases/22140/clear/clear-22140-kvm.img.xz
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In case you want to use or try out a newer version of Clear Linux as the UOS, you can
download the latest from <a class="reference external" href="http://download.clearlinux.org/image">http://download.clearlinux.org/image</a>. Make sure to adjust the steps
described below accordingly (image file name and kernel modules version).</p>
</div>
</li>
<li><p class="first">Uncompress it:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># unxz clear-22140-kvm.img.xz
</pre></div>
</div>
</li>
<li><p class="first">Deploy the UOS kernel modules to UOS virtual disk image (note: you’ll need to use
the same <strong>standard</strong> image version number noted in step 1 above):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># losetup -f -P --show /root/clear-22140-kvm.img
# mount /dev/loop0p3 /mnt
# cp -r /usr/lib/modules/4.14.34-28.pk414-standard /mnt/lib/modules/
# umount /mnt
# sync
</pre></div>
</div>
</li>
<li><p class="first">Edit and Run the <code class="docutils literal notranslate"><span class="pre">launch_uos.sh</span></code> script to launch the UOS.</p>
<p>A sample <a class="reference external" href="https://raw.githubusercontent.com/projectacrn/acrn-hypervisor/master/devicemodel/samples/nuc/launch_uos.sh">launch_uos.sh</a>
is included in the Clear Linux release, and
is also available in the acrn-hypervisor/devicemodel GitHub repo (in the samples
folder) as shown here:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-number">Code Block 2 </span><span class="caption-text">devicemodel/samples/nuc/launch_uos.sh</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="k">function</span> launch_clear<span class="o">()</span>
<span class="o">{</span>
<span class="nv">vm_name</span><span class="o">=</span>vm<span class="nv">$1</span>


<span class="c1">#check if the vm is running or not</span>
<span class="nv">vm_ps</span><span class="o">=</span><span class="k">$(</span>pgrep -a -f acrn-dm<span class="k">)</span>
<span class="nv">result</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$vm_ps</span> <span class="p">|</span> grep <span class="s2">&quot;</span><span class="si">${</span><span class="nv">vm_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$result</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$vm_name</span><span class="s2"> is running, can&#39;t create twice!&quot;</span>
  <span class="nb">exit</span>
<span class="k">fi</span>

<span class="c1">#for memsize setting</span>
<span class="nv">mem_size</span><span class="o">=</span>1000M

<span class="c1"># make sure there is enough 2M hugepages in the pool</span>
<span class="nb">echo</span> <span class="m">1024</span> &gt; /sys/kernel/mm/hugepages/hugepages-2048kB/nr_hugepages

<span class="hll">acrn-dm -A -m <span class="nv">$mem_size</span> -c <span class="nv">$2</span> -s <span class="m">0</span>:0,hostbridge -s <span class="m">1</span>:0,lpc -l com1,stdio <span class="se">\</span>
</span>  -s <span class="m">2</span>,pci-gvt -G <span class="s2">&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span> <span class="se">\</span>
<span class="hll">  -s <span class="m">5</span>,virtio-console,@pty:pty_port <span class="se">\</span>
</span>  -s <span class="m">6</span>,virtio-hyper_dmabuf <span class="se">\</span>
  -s <span class="m">3</span>,virtio-blk,/root/clear-21260-kvm.img <span class="se">\</span>
  -s <span class="m">4</span>,virtio-net,tap0 <span class="se">\</span>
  -k /usr/lib/kernel/org.clearlinux.pk414-standard.4.14.23-19 <span class="se">\</span>
  -B <span class="s2">&quot;root=/dev/vda3 rw rootwait maxcpus=</span><span class="nv">$2</span><span class="s2"> nohpet console=tty0 console=hvc0 \</span>
<span class="s2">  console=ttyS0 no_timer_check ignore_loglevel log_buf_len=16M \</span>
<span class="s2">  consoleblank=0 tsc=reliable i915.avail_planes_per_pipe=</span><span class="nv">$4</span><span class="s2"> \</span>
<span class="s2">  i915.enable_hangcheck=0 i915.nuclear_pageflip=1 i915.enable_initial_modeset=1&quot;</span> <span class="nv">$vm_name</span>
<span class="o">}</span>

launch_clear <span class="m">2</span> <span class="m">1</span> <span class="s2">&quot;64 448 8&quot;</span> 0x070F00 clear
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In case you have downloaded a different Clear Linux image than the one above
(<code class="docutils literal notranslate"><span class="pre">clear-22140-kvm.img.xz</span></code>), you will need to modify the Clear Linux file name
and version number highlighted above (the <code class="docutils literal notranslate"><span class="pre">-s</span> <span class="pre">3,virtio-blk</span></code> argument) to match
what you have downloaded above. Likewise, you may need to adjust the kernel file
name on the second line highlighted (check the exact name to be used using:
<code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">/usr/lib/kernel/org.clearlinux*-standard*</span></code>).</p>
</div>
<p>By default, the script is located in the <code class="docutils literal notranslate"><span class="pre">/usr/share/acrn/samples/nuc/</span></code>
directory. You can edit it there, and then run it to launch the User OS:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># cd /usr/share/acrn/samples/nuc/
# ./launch_uos.sh
</pre></div>
</div>
</li>
<li><p class="first">At this point, you’ve successfully booted the ACRN hypervisor,
SOS, and UOS:</p>
<div class="figure align-center" id="gsg-successful-boot">
<img alt="../_images/gsg-successful-boot.png" src="../_images/gsg-successful-boot.png" />
</div>
</li>
</ol>
</div>
<div class="section" id="device-manager-memory-allocation-mechanism">
<h3>Device Manager memory allocation mechanism<a class="headerlink" href="#device-manager-memory-allocation-mechanism" title="Permalink to this headline">¶</a></h3>
<p>The ACRN Device Manager (DM) virtual memory allocation uses the HugeTLB mechanism.
(You can read more about <a class="reference external" href="https://linuxgazette.net/155/krishnakumar.html">HugeTLB in the linux kernel</a>
for more information about how this mechanism works.)</p>
<p>For hugeTLB to work, you’ll need to reserve huge pages:</p>
<blockquote>
<div><ul>
<li><p class="first">For a (large) 1GB huge page reservation, add <code class="docutils literal notranslate"><span class="pre">hugepagesz=1G</span> <span class="pre">hugepages=reserved_pg_num</span></code>
(for example, <code class="docutils literal notranslate"><span class="pre">hugepagesz=1G</span> <span class="pre">hugepages=4</span></code>) to the SOS cmdline in
<code class="docutils literal notranslate"><span class="pre">acrn.conf</span></code> (for EFI)</p>
</li>
<li><p class="first">For a (smaller) 2MB huge page reservation, after the SOS starts up, run the
command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="n">reserved_pg_num</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">kernel</span><span class="o">/</span><span class="n">mm</span><span class="o">/</span><span class="n">hugepages</span><span class="o">/</span><span class="n">hugepages</span><span class="o">-</span><span class="mi">2048</span><span class="n">kB</span><span class="o">/</span><span class="n">nr_hugepages</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can use 2M reserving method to do reservation for 1G page size, but it
may fail.  For an EFI platform, you may skip 1G page reservation
by using a 2M page, but make sure your huge page reservation size is
large enough for your usage.</p>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="build-acrn-from-source">
<h2>Build ACRN from Source<a class="headerlink" href="#build-acrn-from-source" title="Permalink to this headline">¶</a></h2>
<p>If you would like to build ACRN hypervisor and device model from source,
follow these steps.</p>
<div class="section" id="install-build-tools-and-dependencies">
<h3>Install build tools and dependencies<a class="headerlink" href="#install-build-tools-and-dependencies" title="Permalink to this headline">¶</a></h3>
<p>ARCN development is supported on popular Linux distributions,
each with their own way to install development tools:</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ACRN uses <code class="docutils literal notranslate"><span class="pre">menuconfig</span></code>, a python3 text-based user interface (TUI) for
configuring hypervisor options and using python’s <code class="docutils literal notranslate"><span class="pre">kconfiglib</span></code> library.</p>
</div>
</div></blockquote>
<ul>
<li><p class="first">On a Clear Linux development system, install the <code class="docutils literal notranslate"><span class="pre">os-clr-on-clr</span></code> bundle to get
the necessary tools:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> sudo swupd bundle-add os-clr-on-clr
<span class="gp">$</span> sudo swupd bundle-add python3-basic
<span class="gp">$</span> sudo pip3 install kconfiglib
</pre></div>
</div>
</li>
<li><p class="first">On a Ubuntu/Debian development system:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> sudo apt install gcc <span class="se">\</span>
     git <span class="se">\</span>
     make <span class="se">\</span>
     gnu-efi <span class="se">\</span>
     libssl-dev <span class="se">\</span>
     libpciaccess-dev <span class="se">\</span>
     uuid-dev <span class="se">\</span>
     libsystemd-dev <span class="se">\</span>
     libevent-dev <span class="se">\</span>
     libxml2-dev <span class="se">\</span>
     libusb-1.0-0-dev <span class="se">\</span>
     python3 <span class="se">\</span>
     python3-pip
<span class="gp">$</span> sudo pip3 install kconfiglib
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ubuntu 14.04 requires <code class="docutils literal notranslate"><span class="pre">libsystemd-journal-dev</span></code> instead of <code class="docutils literal notranslate"><span class="pre">libsystemd-dev</span></code>
as indicated above.</p>
</div>
</li>
<li><p class="first">On a Fedora/Redhat development system:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> sudo dnf install gcc <span class="se">\</span>
     git <span class="se">\</span>
     make <span class="se">\</span>
     findutils <span class="se">\</span>
     gnu-efi-devel <span class="se">\</span>
     libuuid-devel <span class="se">\</span>
     openssl-devel <span class="se">\</span>
     libpciaccess-devel <span class="se">\</span>
     systemd-devel <span class="se">\</span>
     libxml2-devel <span class="se">\</span>
     libevent-devel <span class="se">\</span>
     libusbx-devel <span class="se">\</span>
     python3 <span class="se">\</span>
     python3-pip
<span class="gp">$</span> sudo pip3 install kconfiglib
</pre></div>
</div>
</li>
<li><p class="first">On a CentOS development system:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> sudo yum install gcc <span class="se">\</span>
        git <span class="se">\</span>
        make <span class="se">\</span>
        gnu-efi-devel <span class="se">\</span>
        libuuid-devel <span class="se">\</span>
        openssl-devel <span class="se">\</span>
        libpciaccess-devel <span class="se">\</span>
        systemd-devel <span class="se">\</span>
        libxml2-devel <span class="se">\</span>
        libevent-devel <span class="se">\</span>
        libusbx-devel <span class="se">\</span>
        python34 <span class="se">\</span>
        python34-pip
<span class="gp">$</span> sudo pip3 install kconfiglib
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may need to install <a class="reference external" href="https://fedoraproject.org/wiki/EPEL">EPEL</a> for
installing python3 via yum for CentOS 7. For CentOS 6 you need to install
pip manually. Please refer to <a class="reference external" href="https://pip.pypa.io/en/stable/installing">https://pip.pypa.io/en/stable/installing</a> for
details.</p>
</div>
</li>
</ul>
</div>
<div class="section" id="build-the-hypervisor-device-model-and-tools">
<h3>Build the hypervisor, device model and tools<a class="headerlink" href="#build-the-hypervisor-device-model-and-tools" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://github.com/projectacrn/acrn-hypervisor/">acrn-hypervisor</a>
repository has three main components in it:</p>
<ol class="arabic simple">
<li>The ACRN hypervisor code located in the <code class="docutils literal notranslate"><span class="pre">hypervisor</span></code> directory</li>
<li>The ACRN devicemodel code located in the <code class="docutils literal notranslate"><span class="pre">devicemodel</span></code> directory</li>
<li>The ACRN tools source code located in the <code class="docutils literal notranslate"><span class="pre">tools</span></code> directory</li>
</ol>
<p>You can build all these components in one go as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> git clone https://github.com/projectacrn/acrn-hypervisor
<span class="gp">$</span> <span class="nb">cd</span> acrn-hypervisor
<span class="gp">$</span> make
</pre></div>
</div>
<p>The build results are found in the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if you wish to use a different target folder for the build
artefacts, set the <code class="docutils literal notranslate"><span class="pre">O</span></code> (that is capital letter ‘O’) to the
desired value. Example: <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">O=build-uefi</span> <span class="pre">PLATFORM=uefi</span></code>.</p>
</div>
<p>You can also build these components individually. The following
steps assume that you have already cloned the <code class="docutils literal notranslate"><span class="pre">acrn-hypervisor</span></code> repository
and are using it as the current working directory.</p>
<ol class="arabic">
<li><p class="first">Build the ACRN hypervisor.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> hypervisor
<span class="gp">$</span> make <span class="nv">PLATFORM</span><span class="o">=</span>uefi
</pre></div>
</div>
<p>The build results are found in the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory.</p>
</li>
<li><p class="first">Build the ACRN device model (included in the acrn-hypervisor repo):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> ../devicemodel
<span class="gp">$</span> make
</pre></div>
</div>
<p>The build results are found in the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory.</p>
</li>
<li><p class="first">Build the ACRN tools (included in the acrn-hypervisor repo):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> ../tools
<span class="gp">$</span> <span class="k">for</span> d in */<span class="p">;</span> <span class="k">do</span> make -C <span class="s2">&quot;</span><span class="nv">$d</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
</li>
</ol>
<p>Follow the same instructions to boot and test the images you created
from your build.</p>
</div>
<div class="section" id="generate-the-hypervisor-configurations">
<h3>Generate the hypervisor configurations<a class="headerlink" href="#generate-the-hypervisor-configurations" title="Permalink to this headline">¶</a></h3>
<p>The ACRN hypervisor leverages Kconfig to manage configurations, powered by
Kconfiglib. A default configuration is generated based on the platform you have
selected via the <code class="docutils literal notranslate"><span class="pre">PLATFORM=</span></code> command line parameter. You can make further
changes to that default configuration to adjust to your specific
requirements.</p>
<p>To generate hypervisor configurations, you need to build the hypervisor
individually. The following steps generate a default but complete configuration,
based on the platform selected, assuming that you are under the top-level
directory of acrn-hypervisor. The configuration file, named <code class="docutils literal notranslate"><span class="pre">.config</span></code>, can be
found under the target folder of your build.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> hypervisor
<span class="gp">$</span> make defconfig <span class="nv">PLATFORM</span><span class="o">=</span>uefi
</pre></div>
</div>
</div></blockquote>
<p>The PLATFORM specified is used to select a defconfig under
<code class="docutils literal notranslate"><span class="pre">arch/x86/configs/</span></code>. The other command-line based options (e.g. <code class="docutils literal notranslate"><span class="pre">RELEASE</span></code>)
take no effects when generating a defconfig.</p>
</div>
<div class="section" id="modify-the-hypervisor-configurations">
<h3>Modify the hypervisor configurations<a class="headerlink" href="#modify-the-hypervisor-configurations" title="Permalink to this headline">¶</a></h3>
<p>To modify the hypervisor configurations, you can either edit <code class="docutils literal notranslate"><span class="pre">.config</span></code>
manually, or invoke a TUI-based menuconfig, powered by kconfiglib, by executing
<code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">menuconfig</span></code>. As an example, the following commands, assuming that you
are under the top-level directory of acrn-hypervisor, generate a default
configuration file for UEFI, allow you to modify some configurations and build
the hypervisor using the updated <code class="docutils literal notranslate"><span class="pre">.config</span></code>.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> hypervisor
<span class="gp">$</span> make defconfig <span class="nv">PLATFORM</span><span class="o">=</span>uefi
<span class="gp">$</span> make menuconfig              <span class="c1"># Modify the configurations per your needs</span>
<span class="gp">$</span> make                         <span class="c1"># Build the hypervisor with the new .config</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Menuconfig is python3 only.</p>
</div>
</div></blockquote>
<p>Refer to the help on menuconfig for a detailed guide on the interface.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pydoc3 menuconfig
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="create-a-new-default-configuration">
<h3>Create a new default configuration<a class="headerlink" href="#create-a-new-default-configuration" title="Permalink to this headline">¶</a></h3>
<p>Currently the ACRN hypervisor looks for default configurations under
<code class="docutils literal notranslate"><span class="pre">hypervisor/arch/x86/configs/&lt;PLATFORM&gt;.config</span></code>, where <code class="docutils literal notranslate"><span class="pre">&lt;PLATFORM&gt;</span></code> is the
specified platform. The following steps allow you to create a defconfig for
another platform based on a current one.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> hypervisor
<span class="gp">$</span> make defconfig <span class="nv">PLATFORM</span><span class="o">=</span>uefi
<span class="gp">$</span> make menuconfig         <span class="c1"># Modify the configurations</span>
<span class="gp">$</span> make savedefconfig      <span class="c1"># The minimized config reside at build/defconfig</span>
<span class="gp">$</span> cp build/defconfig arch/x86/configs/xxx.config
</pre></div>
</div>
</div></blockquote>
<p>Then you can re-use that configuration by passing the name (<code class="docutils literal notranslate"><span class="pre">xxx</span></code> in the
example above) to ‘PLATFORM=’:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> make defconfig <span class="nv">PLATFORM</span><span class="o">=</span>xxx
</pre></div>
</div>
</div></blockquote>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Project ACRN.
      Last updated on Jul 04, 2018.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v 0.1-rc5',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>